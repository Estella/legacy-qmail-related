diff -urN ../vpopmail-5.4.10/Makefile.in ./Makefile.in
--- ../vpopmail-5.4.10/Makefile.in	Sun Mar 20 07:38:35 2005
+++ ./Makefile.in	Thu Apr 28 12:35:59 2005
@@ -1,8 +1,6 @@
-# Makefile.in generated by automake 1.6.3 from Makefile.am.
-# @configure_input@
+# Makefile.in generated automatically by automake 1.4-p4 from Makefile.am
 
-# Copyright 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002
-# Free Software Foundation, Inc.
+# Copyright (C) 1994, 1995-8, 1999 Free Software Foundation, Inc.
 # This Makefile.in is free software; the Free Software Foundation
 # gives unlimited permission to copy and/or distribute it,
 # with or without modifications, as long as this notice is preserved.
@@ -12,9 +10,9 @@
 # even the implied warranty of MERCHANTABILITY or FITNESS FOR A
 # PARTICULAR PURPOSE.
 
-@SET_MAKE@
-
 # Copyright (C) 1999-2003 Inter7 Internet Technologies, Inc.
+
+
 SHELL = @SHELL@
 
 srcdir = @srcdir@
@@ -35,9 +33,13 @@
 mandir = @mandir@
 includedir = @includedir@
 oldincludedir = /usr/include
+
+DESTDIR =
+
 pkgdatadir = $(datadir)/@PACKAGE@
 pkglibdir = $(libdir)/@PACKAGE@
 pkgincludedir = $(includedir)/@PACKAGE@
+
 top_builddir = .
 
 ACLOCAL = @ACLOCAL@
@@ -45,15 +47,11 @@
 AUTOMAKE = @AUTOMAKE@
 AUTOHEADER = @AUTOHEADER@
 
-am__cd = CDPATH="$${ZSH_VERSION+.}$(PATH_SEPARATOR)" && cd
 INSTALL = @INSTALL@
 INSTALL_DATA = @INSTALL_DATA@
-install_sh_DATA = $(install_sh) -c -m 644
-install_sh_PROGRAM = $(install_sh) -c
-install_sh_SCRIPT = $(install_sh) -c
 INSTALL_SCRIPT = @INSTALL_SCRIPT@
-INSTALL_HEADER = $(INSTALL_DATA)
 transform = @program_transform_name@
+
 NORMAL_INSTALL = :
 PRE_INSTALL = :
 POST_INSTALL = :
@@ -62,40 +60,32 @@
 POST_UNINSTALL = :
 host_alias = @host_alias@
 host_triplet = @host@
-
-EXEEXT = @EXEEXT@
-PATH_SEPARATOR = @PATH_SEPARATOR@
-
-INSTALL_PROGRAM = ${INSTALL} -o @vpopuser@ -m 711 -g @vpopgroup@ $(AM_INSTALL_PROGRAM_FLAGS)
-OBJEXT = o
-AMTAR = @AMTAR@
 AWK = @AWK@
 CC = @CC@
-DEPDIR = @DEPDIR@
-INSTALL_STRIP_PROGRAM = ${INSTALL_PROGRAM} -s
+MAKEINFO = @MAKEINFO@
 PACKAGE = @PACKAGE@
 RANLIB = @RANLIB@
-STRIP = @STRIP@
 USE_MYSQL = @USE_MYSQL@
 VERSION = @VERSION@
-am__include = @am__include@
-am__quote = @am__quote@
 auth_inc = @auth_inc@
 auth_libs = @auth_libs@
 authlib = @authlib@
 domains_dir = @domains_dir@
-install_sh = @install_sh@
 vpopgroup = @vpopgroup@
 vpopmaildir = @vpopmaildir@
 vpopuser = @vpopuser@
 
 SUBDIRS = cdb
+OBJEXT = o
 
 noinst_LIBRARIES = libvpopmail.a
 
 COMMONSOURCES = vpopmail.c md5.c bigdir.c vauth.c file_lock.c vpalias.c seek.c vlimits.c maildirquota.c
 CONFIG_CLEAN_FILES = vauth.c
 
+INSTALL_PROGRAM = ${INSTALL} -o @vpopuser@ -m 711 -g @vpopgroup@ $(AM_INSTALL_PROGRAM_FLAGS)
+INSTALL_STRIP_PROGRAM = ${INSTALL_PROGRAM} -s
+
 MYSQLCONF = $(DESTDIR)@vpopmaildir@/etc/vpopmail.mysql
 VLIMITS = $(DESTDIR)@vpopmaildir@/etc/vlimits.default
 
@@ -103,10 +93,7 @@
 libvpopmail_a_LIBADD = cdb/*.o
 
 vpopmailbindir = @vpopmaildir@/bin
-vpopmailbin_PROGRAMS = vchkpw vdelivermail clearopensmtp vadddomain \
- vdeldomain vpasswd vadduser vdeluser vaddaliasdomain vsetuserquota \
- vpopbull vdeloldusers vmoduser valias vuserinfo vmkpasswd vipmap \
- vdominfo vconvert vkill vmoddomlimits vchangepw dotqmail2valias
+vpopmailbin_PROGRAMS = vchkpw vdelivermail clearopensmtp vadddomain  vdeldomain vpasswd vadduser vdeluser vaddaliasdomain vsetuserquota  vpopbull vdeloldusers vmoduser valias vuserinfo vmkpasswd vipmap  vdominfo vconvert vkill vmoddomlimits vchangepw dotqmail2valias
 
 
 vuserinfo_SOURCES = vuserinfo.c maildirquota.c
@@ -127,9 +114,9 @@
 vdelivermail_SOURCES = vdelivermail.c maildirquota.c
 vdelivermail_LDADD = libvpopmail.a @auth_libs@
 
-
 # vqmaillocal_SOURCES = vqmaillocal.c 
 # vqmaillocal_LDADD = libvpopmail.a @auth_libs@
+
 vkill_SOURCES = vkill.c 
 vkill_LDADD = libvpopmail.a @auth_libs@
 
@@ -184,308 +171,300 @@
 DEFS = -I. @auth_inc@ 
 
 AUTOMAKE_OPTIONS = foreign no-dependencies
-subdir = .
 ACLOCAL_M4 = $(top_srcdir)/aclocal.m4
 mkinstalldirs = $(SHELL) $(top_srcdir)/mkinstalldirs
 CONFIG_HEADER = config.h
-LIBRARIES = $(noinst_LIBRARIES)
+LIBRARIES =  $(noinst_LIBRARIES)
 
-libvpopmail_a_AR = $(AR) cru
-libvpopmail_a_DEPENDENCIES = cdb/*.o
-am__objects_1 = vpopmail.$(OBJEXT) md5.$(OBJEXT) bigdir.$(OBJEXT) \
-	vauth.$(OBJEXT) file_lock.$(OBJEXT) vpalias.$(OBJEXT) \
-	seek.$(OBJEXT) vlimits.$(OBJEXT) maildirquota.$(OBJEXT)
-am_libvpopmail_a_OBJECTS = $(am__objects_1)
-libvpopmail_a_OBJECTS = $(am_libvpopmail_a_OBJECTS)
-vpopmailbin_PROGRAMS = vchkpw$(EXEEXT) vdelivermail$(EXEEXT) \
-	clearopensmtp$(EXEEXT) vadddomain$(EXEEXT) vdeldomain$(EXEEXT) \
-	vpasswd$(EXEEXT) vadduser$(EXEEXT) vdeluser$(EXEEXT) \
-	vaddaliasdomain$(EXEEXT) vsetuserquota$(EXEEXT) \
-	vpopbull$(EXEEXT) vdeloldusers$(EXEEXT) vmoduser$(EXEEXT) \
-	valias$(EXEEXT) vuserinfo$(EXEEXT) vmkpasswd$(EXEEXT) \
-	vipmap$(EXEEXT) vdominfo$(EXEEXT) vconvert$(EXEEXT) \
-	vkill$(EXEEXT) vmoddomlimits$(EXEEXT) vchangepw$(EXEEXT) \
-	dotqmail2valias$(EXEEXT)
-PROGRAMS = $(vpopmailbin_PROGRAMS)
-
-am_clearopensmtp_OBJECTS = clearopensmtp.$(OBJEXT)
-clearopensmtp_OBJECTS = $(am_clearopensmtp_OBJECTS)
-clearopensmtp_DEPENDENCIES = libvpopmail.a
-clearopensmtp_LDFLAGS =
-am_dotqmail2valias_OBJECTS = dotqmail2valias.$(OBJEXT)
-dotqmail2valias_OBJECTS = $(am_dotqmail2valias_OBJECTS)
-dotqmail2valias_DEPENDENCIES = libvpopmail.a
-dotqmail2valias_LDFLAGS =
-am_vaddaliasdomain_OBJECTS = vaddaliasdomain.$(OBJEXT)
-vaddaliasdomain_OBJECTS = $(am_vaddaliasdomain_OBJECTS)
-vaddaliasdomain_DEPENDENCIES = libvpopmail.a
-vaddaliasdomain_LDFLAGS =
-am_vadddomain_OBJECTS = vadddomain.$(OBJEXT)
-vadddomain_OBJECTS = $(am_vadddomain_OBJECTS)
-vadddomain_DEPENDENCIES = libvpopmail.a
-vadddomain_LDFLAGS =
-am_vadduser_OBJECTS = vadduser.$(OBJEXT)
-vadduser_OBJECTS = $(am_vadduser_OBJECTS)
-vadduser_DEPENDENCIES = libvpopmail.a
-vadduser_LDFLAGS =
-am_valias_OBJECTS = valias.$(OBJEXT)
-valias_OBJECTS = $(am_valias_OBJECTS)
-valias_DEPENDENCIES = libvpopmail.a
-valias_LDFLAGS =
-am_vchangepw_OBJECTS = vchangepw.$(OBJEXT)
-vchangepw_OBJECTS = $(am_vchangepw_OBJECTS)
-vchangepw_DEPENDENCIES = libvpopmail.a
-vchangepw_LDFLAGS =
-am_vchkpw_OBJECTS = vchkpw.$(OBJEXT) md5.$(OBJEXT) hmac_md5.$(OBJEXT)
-vchkpw_OBJECTS = $(am_vchkpw_OBJECTS)
-vchkpw_DEPENDENCIES = libvpopmail.a
-vchkpw_LDFLAGS =
-am_vconvert_OBJECTS = vconvert.$(OBJEXT)
-vconvert_OBJECTS = $(am_vconvert_OBJECTS)
-vconvert_DEPENDENCIES = libvpopmail.a
-vconvert_LDFLAGS =
-am_vdeldomain_OBJECTS = vdeldomain.$(OBJEXT)
-vdeldomain_OBJECTS = $(am_vdeldomain_OBJECTS)
-vdeldomain_DEPENDENCIES = libvpopmail.a
-vdeldomain_LDFLAGS =
-am_vdelivermail_OBJECTS = vdelivermail.$(OBJEXT) maildirquota.$(OBJEXT)
-vdelivermail_OBJECTS = $(am_vdelivermail_OBJECTS)
-vdelivermail_DEPENDENCIES = libvpopmail.a
-vdelivermail_LDFLAGS =
-am_vdeloldusers_OBJECTS = vdeloldusers.$(OBJEXT)
-vdeloldusers_OBJECTS = $(am_vdeloldusers_OBJECTS)
-vdeloldusers_DEPENDENCIES = libvpopmail.a
-vdeloldusers_LDFLAGS =
-am_vdeluser_OBJECTS = vdeluser.$(OBJEXT)
-vdeluser_OBJECTS = $(am_vdeluser_OBJECTS)
-vdeluser_DEPENDENCIES = libvpopmail.a
-vdeluser_LDFLAGS =
-am_vdominfo_OBJECTS = vdominfo.$(OBJEXT)
-vdominfo_OBJECTS = $(am_vdominfo_OBJECTS)
-vdominfo_DEPENDENCIES = libvpopmail.a
-vdominfo_LDFLAGS =
-am_vipmap_OBJECTS = vipmap.$(OBJEXT)
-vipmap_OBJECTS = $(am_vipmap_OBJECTS)
-vipmap_DEPENDENCIES = libvpopmail.a
-vipmap_LDFLAGS =
-am_vkill_OBJECTS = vkill.$(OBJEXT)
-vkill_OBJECTS = $(am_vkill_OBJECTS)
-vkill_DEPENDENCIES = libvpopmail.a
-vkill_LDFLAGS =
-am_vmkpasswd_OBJECTS = vmkpasswd.$(OBJEXT)
-vmkpasswd_OBJECTS = $(am_vmkpasswd_OBJECTS)
-vmkpasswd_DEPENDENCIES = libvpopmail.a
-vmkpasswd_LDFLAGS =
-am_vmoddomlimits_OBJECTS = vmoddomlimits.$(OBJEXT)
-vmoddomlimits_OBJECTS = $(am_vmoddomlimits_OBJECTS)
-vmoddomlimits_DEPENDENCIES = libvpopmail.a
-vmoddomlimits_LDFLAGS =
-am_vmoduser_OBJECTS = vmoduser.$(OBJEXT)
-vmoduser_OBJECTS = $(am_vmoduser_OBJECTS)
-vmoduser_DEPENDENCIES = libvpopmail.a
-vmoduser_LDFLAGS =
-am_vpasswd_OBJECTS = vpasswd.$(OBJEXT)
-vpasswd_OBJECTS = $(am_vpasswd_OBJECTS)
-vpasswd_DEPENDENCIES = libvpopmail.a
-vpasswd_LDFLAGS =
-am_vpopbull_OBJECTS = vpopbull.$(OBJEXT)
-vpopbull_OBJECTS = $(am_vpopbull_OBJECTS)
-vpopbull_DEPENDENCIES = libvpopmail.a
-vpopbull_LDFLAGS =
-am_vsetuserquota_OBJECTS = vsetuserquota.$(OBJEXT)
-vsetuserquota_OBJECTS = $(am_vsetuserquota_OBJECTS)
-vsetuserquota_DEPENDENCIES = libvpopmail.a
-vsetuserquota_LDFLAGS =
-am_vuserinfo_OBJECTS = vuserinfo.$(OBJEXT) maildirquota.$(OBJEXT)
-vuserinfo_OBJECTS = $(am_vuserinfo_OBJECTS)
-vuserinfo_DEPENDENCIES = libvpopmail.a
-vuserinfo_LDFLAGS =
-DEFAULT_INCLUDES =  -I. -I$(srcdir) -I.
 CPPFLAGS = @CPPFLAGS@
 LDFLAGS = @LDFLAGS@
 LIBS = @LIBS@
-depcomp =
-am__depfiles_maybe =
-COMPILE = $(CC) $(DEFS) $(DEFAULT_INCLUDES) $(INCLUDES) $(AM_CPPFLAGS) \
-	$(CPPFLAGS) $(AM_CFLAGS) $(CFLAGS)
-CCLD = $(CC)
-LINK = $(CCLD) $(AM_CFLAGS) $(CFLAGS) $(AM_LDFLAGS) $(LDFLAGS) -o $@
+libvpopmail_a_DEPENDENCIES =  cdb/*.o
+libvpopmail_a_OBJECTS =  vpopmail.o md5.o bigdir.o vauth.o file_lock.o \
+vpalias.o seek.o vlimits.o maildirquota.o
+AR = ar
+PROGRAMS =  $(vpopmailbin_PROGRAMS)
+
+vchkpw_OBJECTS =  vchkpw.o md5.o hmac_md5.o
+vchkpw_DEPENDENCIES =  libvpopmail.a
+vchkpw_LDFLAGS = 
+vdelivermail_OBJECTS =  vdelivermail.o maildirquota.o
+vdelivermail_DEPENDENCIES =  libvpopmail.a
+vdelivermail_LDFLAGS = 
+clearopensmtp_OBJECTS =  clearopensmtp.o
+clearopensmtp_DEPENDENCIES =  libvpopmail.a
+clearopensmtp_LDFLAGS = 
+vadddomain_OBJECTS =  vadddomain.o
+vadddomain_DEPENDENCIES =  libvpopmail.a
+vadddomain_LDFLAGS = 
+vdeldomain_OBJECTS =  vdeldomain.o
+vdeldomain_DEPENDENCIES =  libvpopmail.a
+vdeldomain_LDFLAGS = 
+vpasswd_OBJECTS =  vpasswd.o
+vpasswd_DEPENDENCIES =  libvpopmail.a
+vpasswd_LDFLAGS = 
+vadduser_OBJECTS =  vadduser.o
+vadduser_DEPENDENCIES =  libvpopmail.a
+vadduser_LDFLAGS = 
+vdeluser_OBJECTS =  vdeluser.o
+vdeluser_DEPENDENCIES =  libvpopmail.a
+vdeluser_LDFLAGS = 
+vaddaliasdomain_OBJECTS =  vaddaliasdomain.o
+vaddaliasdomain_DEPENDENCIES =  libvpopmail.a
+vaddaliasdomain_LDFLAGS = 
+vsetuserquota_OBJECTS =  vsetuserquota.o
+vsetuserquota_DEPENDENCIES =  libvpopmail.a
+vsetuserquota_LDFLAGS = 
+vpopbull_OBJECTS =  vpopbull.o
+vpopbull_DEPENDENCIES =  libvpopmail.a
+vpopbull_LDFLAGS = 
+vdeloldusers_OBJECTS =  vdeloldusers.o
+vdeloldusers_DEPENDENCIES =  libvpopmail.a
+vdeloldusers_LDFLAGS = 
+vmoduser_OBJECTS =  vmoduser.o
+vmoduser_DEPENDENCIES =  libvpopmail.a
+vmoduser_LDFLAGS = 
+valias_OBJECTS =  valias.o
+valias_DEPENDENCIES =  libvpopmail.a
+valias_LDFLAGS = 
+vuserinfo_OBJECTS =  vuserinfo.o maildirquota.o
+vuserinfo_DEPENDENCIES =  libvpopmail.a
+vuserinfo_LDFLAGS = 
+vmkpasswd_OBJECTS =  vmkpasswd.o
+vmkpasswd_DEPENDENCIES =  libvpopmail.a
+vmkpasswd_LDFLAGS = 
+vipmap_OBJECTS =  vipmap.o
+vipmap_DEPENDENCIES =  libvpopmail.a
+vipmap_LDFLAGS = 
+vdominfo_OBJECTS =  vdominfo.o
+vdominfo_DEPENDENCIES =  libvpopmail.a
+vdominfo_LDFLAGS = 
+vconvert_OBJECTS =  vconvert.o
+vconvert_DEPENDENCIES =  libvpopmail.a
+vconvert_LDFLAGS = 
+vkill_OBJECTS =  vkill.o
+vkill_DEPENDENCIES =  libvpopmail.a
+vkill_LDFLAGS = 
+vmoddomlimits_OBJECTS =  vmoddomlimits.o
+vmoddomlimits_DEPENDENCIES =  libvpopmail.a
+vmoddomlimits_LDFLAGS = 
+vchangepw_OBJECTS =  vchangepw.o
+vchangepw_DEPENDENCIES =  libvpopmail.a
+vchangepw_LDFLAGS = 
+dotqmail2valias_OBJECTS =  dotqmail2valias.o
+dotqmail2valias_DEPENDENCIES =  libvpopmail.a
+dotqmail2valias_LDFLAGS = 
 CFLAGS = @CFLAGS@
-DIST_SOURCES = $(libvpopmail_a_SOURCES) $(clearopensmtp_SOURCES) \
-	$(dotqmail2valias_SOURCES) $(vaddaliasdomain_SOURCES) \
-	$(vadddomain_SOURCES) $(vadduser_SOURCES) $(valias_SOURCES) \
-	$(vchangepw_SOURCES) $(vchkpw_SOURCES) $(vconvert_SOURCES) \
-	$(vdeldomain_SOURCES) $(vdelivermail_SOURCES) \
-	$(vdeloldusers_SOURCES) $(vdeluser_SOURCES) $(vdominfo_SOURCES) \
-	$(vipmap_SOURCES) $(vkill_SOURCES) $(vmkpasswd_SOURCES) \
-	$(vmoddomlimits_SOURCES) $(vmoduser_SOURCES) $(vpasswd_SOURCES) \
-	$(vpopbull_SOURCES) $(vsetuserquota_SOURCES) \
-	$(vuserinfo_SOURCES)
-
-RECURSIVE_TARGETS = info-recursive dvi-recursive install-info-recursive \
-	uninstall-info-recursive all-recursive install-data-recursive \
-	install-exec-recursive installdirs-recursive install-recursive \
-	uninstall-recursive check-recursive installcheck-recursive
-DIST_COMMON = README AUTHORS COPYING ChangeLog INSTALL Makefile.am \
-	Makefile.in aclocal.m4 config.guess config.h.in config.sub \
-	configure configure.in install-sh ltmain.sh missing \
-	mkinstalldirs
-DIST_SUBDIRS = $(SUBDIRS)
-SOURCES = $(libvpopmail_a_SOURCES) $(clearopensmtp_SOURCES) $(dotqmail2valias_SOURCES) $(vaddaliasdomain_SOURCES) $(vadddomain_SOURCES) $(vadduser_SOURCES) $(valias_SOURCES) $(vchangepw_SOURCES) $(vchkpw_SOURCES) $(vconvert_SOURCES) $(vdeldomain_SOURCES) $(vdelivermail_SOURCES) $(vdeloldusers_SOURCES) $(vdeluser_SOURCES) $(vdominfo_SOURCES) $(vipmap_SOURCES) $(vkill_SOURCES) $(vmkpasswd_SOURCES) $(vmoddomlimits_SOURCES) $(vmoduser_SOURCES) $(vpasswd_SOURCES) $(vpopbull_SOURCES) $(vsetuserquota_SOURCES) $(vuserinfo_SOURCES)
+COMPILE = $(CC) $(DEFS) $(INCLUDES) $(AM_CPPFLAGS) $(CPPFLAGS) $(AM_CFLAGS) $(CFLAGS)
+CCLD = $(CC)
+LINK = $(CCLD) $(AM_CFLAGS) $(CFLAGS) $(LDFLAGS) -o $@
+DIST_COMMON =  README ./stamp-h.in AUTHORS COPYING ChangeLog INSTALL \
+Makefile.am Makefile.in aclocal.m4 config.guess config.h.in config.sub \
+configure configure.in install-sh ltmain.sh missing mkinstalldirs
 
-all: config.h
-	$(MAKE) $(AM_MAKEFLAGS) all-recursive
 
+DISTFILES = $(DIST_COMMON) $(SOURCES) $(HEADERS) $(TEXINFOS) $(EXTRA_DIST)
+
+TAR = tar
+GZIP_ENV = --best
+SOURCES = $(libvpopmail_a_SOURCES) $(vchkpw_SOURCES) $(vdelivermail_SOURCES) $(clearopensmtp_SOURCES) $(vadddomain_SOURCES) $(vdeldomain_SOURCES) $(vpasswd_SOURCES) $(vadduser_SOURCES) $(vdeluser_SOURCES) $(vaddaliasdomain_SOURCES) $(vsetuserquota_SOURCES) $(vpopbull_SOURCES) $(vdeloldusers_SOURCES) $(vmoduser_SOURCES) $(valias_SOURCES) $(vuserinfo_SOURCES) $(vmkpasswd_SOURCES) $(vipmap_SOURCES) $(vdominfo_SOURCES) $(vconvert_SOURCES) $(vkill_SOURCES) $(vmoddomlimits_SOURCES) $(vchangepw_SOURCES) $(dotqmail2valias_SOURCES)
+OBJECTS = $(libvpopmail_a_OBJECTS) $(vchkpw_OBJECTS) $(vdelivermail_OBJECTS) $(clearopensmtp_OBJECTS) $(vadddomain_OBJECTS) $(vdeldomain_OBJECTS) $(vpasswd_OBJECTS) $(vadduser_OBJECTS) $(vdeluser_OBJECTS) $(vaddaliasdomain_OBJECTS) $(vsetuserquota_OBJECTS) $(vpopbull_OBJECTS) $(vdeloldusers_OBJECTS) $(vmoduser_OBJECTS) $(valias_OBJECTS) $(vuserinfo_OBJECTS) $(vmkpasswd_OBJECTS) $(vipmap_OBJECTS) $(vdominfo_OBJECTS) $(vconvert_OBJECTS) $(vkill_OBJECTS) $(vmoddomlimits_OBJECTS) $(vchangepw_OBJECTS) $(dotqmail2valias_OBJECTS)
+
+all: all-redirect
 .SUFFIXES:
-.SUFFIXES: .c .o .obj
+.SUFFIXES: .S .c .o .s
+$(srcdir)/Makefile.in: Makefile.am $(top_srcdir)/configure.in $(ACLOCAL_M4) 
+	cd $(top_srcdir) && $(AUTOMAKE) --foreign Makefile
+
+Makefile: $(srcdir)/Makefile.in  $(top_builddir)/config.status
+	cd $(top_builddir) \
+	  && CONFIG_FILES=$@ CONFIG_HEADERS= $(SHELL) ./config.status
 
-am__CONFIG_DISTCLEAN_FILES = config.status config.cache config.log \
- configure.lineno
-$(srcdir)/Makefile.in:  Makefile.am  $(top_srcdir)/configure.in $(ACLOCAL_M4)
-	cd $(top_srcdir) && \
-	  $(AUTOMAKE) --foreign  Makefile
-Makefile:  $(srcdir)/Makefile.in  $(top_builddir)/config.status
-	cd $(top_builddir) && $(SHELL) ./config.status $@ $(am__depfiles_maybe)
+$(ACLOCAL_M4):  configure.in 
+	cd $(srcdir) && $(ACLOCAL)
 
-$(top_builddir)/config.status: $(srcdir)/configure $(CONFIG_STATUS_DEPENDENCIES)
+config.status: $(srcdir)/configure.in $(CONFIG_STATUS_DEPENDENCIES)
 	$(SHELL) ./config.status --recheck
-$(srcdir)/configure:  $(srcdir)/configure.in $(ACLOCAL_M4) $(CONFIGURE_DEPENDENCIES)
+$(srcdir)/configure: $(srcdir)/configure.in $(ACLOCAL_M4) $(CONFIGURE_DEPENDENCIES)
 	cd $(srcdir) && $(AUTOCONF)
 
-$(ACLOCAL_M4):  configure.in 
-	cd $(srcdir) && $(ACLOCAL) $(ACLOCAL_AMFLAGS)
-
-config.h: stamp-h1
+config.h: stamp-h
 	@if test ! -f $@; then \
-	  rm -f stamp-h1; \
-	  $(MAKE) stamp-h1; \
+		rm -f stamp-h; \
+		$(MAKE) stamp-h; \
 	else :; fi
+stamp-h: $(srcdir)/config.h.in $(top_builddir)/config.status
+	cd $(top_builddir) \
+	  && CONFIG_FILES= CONFIG_HEADERS=config.h \
+	     $(SHELL) ./config.status
+	@echo timestamp > stamp-h 2> /dev/null
+$(srcdir)/config.h.in: $(srcdir)/stamp-h.in
+	@if test ! -f $@; then \
+		rm -f $(srcdir)/stamp-h.in; \
+		$(MAKE) $(srcdir)/stamp-h.in; \
+	else :; fi
+$(srcdir)/stamp-h.in: $(top_srcdir)/configure.in $(ACLOCAL_M4) 
+	cd $(top_srcdir) && $(AUTOHEADER)
+	@echo timestamp > $(srcdir)/stamp-h.in 2> /dev/null
 
-stamp-h1: $(srcdir)/config.h.in $(top_builddir)/config.status
-	@rm -f stamp-h1
-	cd $(top_builddir) && $(SHELL) ./config.status config.h
+mostlyclean-hdr:
 
-$(srcdir)/config.h.in:  $(top_srcdir)/configure.in $(ACLOCAL_M4) 
-	cd $(top_srcdir) && $(AUTOHEADER)
-	touch $(srcdir)/config.h.in
+clean-hdr:
 
 distclean-hdr:
-	-rm -f config.h stamp-h1
+	-rm -f config.h
 
-AR = ar
+maintainer-clean-hdr:
+
+mostlyclean-noinstLIBRARIES:
 
 clean-noinstLIBRARIES:
 	-test -z "$(noinst_LIBRARIES)" || rm -f $(noinst_LIBRARIES)
-libvpopmail.a: $(libvpopmail_a_OBJECTS) $(libvpopmail_a_DEPENDENCIES) 
+
+distclean-noinstLIBRARIES:
+
+maintainer-clean-noinstLIBRARIES:
+
+.c.o:
+	$(COMPILE) -c $<
+
+.s.o:
+	$(COMPILE) -c $<
+
+.S.o:
+	$(COMPILE) -c $<
+
+mostlyclean-compile:
+	-rm -f *.o core *.core
+
+clean-compile:
+
+distclean-compile:
+	-rm -f *.tab.c
+
+maintainer-clean-compile:
+
+libvpopmail.a: $(libvpopmail_a_OBJECTS) $(libvpopmail_a_DEPENDENCIES)
 	-rm -f libvpopmail.a
-	$(libvpopmail_a_AR) libvpopmail.a $(libvpopmail_a_OBJECTS) $(libvpopmail_a_LIBADD)
+	$(AR) cru libvpopmail.a $(libvpopmail_a_OBJECTS) $(libvpopmail_a_LIBADD)
 	$(RANLIB) libvpopmail.a
-vpopmailbinPROGRAMS_INSTALL = $(INSTALL_PROGRAM)
+
+mostlyclean-vpopmailbinPROGRAMS:
+
+clean-vpopmailbinPROGRAMS:
+	-test -z "$(vpopmailbin_PROGRAMS)" || rm -f $(vpopmailbin_PROGRAMS)
+
+distclean-vpopmailbinPROGRAMS:
+
+maintainer-clean-vpopmailbinPROGRAMS:
+
 install-vpopmailbinPROGRAMS: $(vpopmailbin_PROGRAMS)
 	@$(NORMAL_INSTALL)
 	$(mkinstalldirs) $(DESTDIR)$(vpopmailbindir)
 	@list='$(vpopmailbin_PROGRAMS)'; for p in $$list; do \
-	  p1=`echo $$p|sed 's/$(EXEEXT)$$//'`; \
-	  if test -f $$p \
-	  ; then \
-	    f=`echo "$$p1" | sed 's,^.*/,,;$(transform);s/$$/$(EXEEXT)/'`; \
-	   echo " $(INSTALL_PROGRAM_ENV) $(vpopmailbinPROGRAMS_INSTALL) $$p $(DESTDIR)$(vpopmailbindir)/$$f"; \
-	   $(INSTALL_PROGRAM_ENV) $(vpopmailbinPROGRAMS_INSTALL) $$p $(DESTDIR)$(vpopmailbindir)/$$f; \
+	  if test -f $$p; then \
+	    echo "  $(INSTALL_PROGRAM) $$p $(DESTDIR)$(vpopmailbindir)/`echo $$p|sed 's/$(EXEEXT)$$//'|sed '$(transform)'|sed 's/$$/$(EXEEXT)/'`"; \
+	     $(INSTALL_PROGRAM) $$p $(DESTDIR)$(vpopmailbindir)/`echo $$p|sed 's/$(EXEEXT)$$//'|sed '$(transform)'|sed 's/$$/$(EXEEXT)/'`; \
 	  else :; fi; \
 	done
 
 uninstall-vpopmailbinPROGRAMS:
 	@$(NORMAL_UNINSTALL)
-	@list='$(vpopmailbin_PROGRAMS)'; for p in $$list; do \
-	  f=`echo "$$p" | sed 's,^.*/,,;s/$(EXEEXT)$$//;$(transform);s/$$/$(EXEEXT)/'`; \
-	  echo " rm -f $(DESTDIR)$(vpopmailbindir)/$$f"; \
-	  rm -f $(DESTDIR)$(vpopmailbindir)/$$f; \
+	list='$(vpopmailbin_PROGRAMS)'; for p in $$list; do \
+	  rm -f $(DESTDIR)$(vpopmailbindir)/`echo $$p|sed 's/$(EXEEXT)$$//'|sed '$(transform)'|sed 's/$$/$(EXEEXT)/'`; \
 	done
 
-clean-vpopmailbinPROGRAMS:
-	-test -z "$(vpopmailbin_PROGRAMS)" || rm -f $(vpopmailbin_PROGRAMS)
-clearopensmtp$(EXEEXT): $(clearopensmtp_OBJECTS) $(clearopensmtp_DEPENDENCIES) 
-	@rm -f clearopensmtp$(EXEEXT)
+vchkpw: $(vchkpw_OBJECTS) $(vchkpw_DEPENDENCIES)
+	@rm -f vchkpw
+	$(LINK) $(vchkpw_LDFLAGS) $(vchkpw_OBJECTS) $(vchkpw_LDADD) $(LIBS)
+
+vdelivermail: $(vdelivermail_OBJECTS) $(vdelivermail_DEPENDENCIES)
+	@rm -f vdelivermail
+	$(LINK) $(vdelivermail_LDFLAGS) $(vdelivermail_OBJECTS) $(vdelivermail_LDADD) $(LIBS)
+
+clearopensmtp: $(clearopensmtp_OBJECTS) $(clearopensmtp_DEPENDENCIES)
+	@rm -f clearopensmtp
 	$(LINK) $(clearopensmtp_LDFLAGS) $(clearopensmtp_OBJECTS) $(clearopensmtp_LDADD) $(LIBS)
-dotqmail2valias$(EXEEXT): $(dotqmail2valias_OBJECTS) $(dotqmail2valias_DEPENDENCIES) 
-	@rm -f dotqmail2valias$(EXEEXT)
-	$(LINK) $(dotqmail2valias_LDFLAGS) $(dotqmail2valias_OBJECTS) $(dotqmail2valias_LDADD) $(LIBS)
-vaddaliasdomain$(EXEEXT): $(vaddaliasdomain_OBJECTS) $(vaddaliasdomain_DEPENDENCIES) 
-	@rm -f vaddaliasdomain$(EXEEXT)
-	$(LINK) $(vaddaliasdomain_LDFLAGS) $(vaddaliasdomain_OBJECTS) $(vaddaliasdomain_LDADD) $(LIBS)
-vadddomain$(EXEEXT): $(vadddomain_OBJECTS) $(vadddomain_DEPENDENCIES) 
-	@rm -f vadddomain$(EXEEXT)
+
+vadddomain: $(vadddomain_OBJECTS) $(vadddomain_DEPENDENCIES)
+	@rm -f vadddomain
 	$(LINK) $(vadddomain_LDFLAGS) $(vadddomain_OBJECTS) $(vadddomain_LDADD) $(LIBS)
-vadduser$(EXEEXT): $(vadduser_OBJECTS) $(vadduser_DEPENDENCIES) 
-	@rm -f vadduser$(EXEEXT)
-	$(LINK) $(vadduser_LDFLAGS) $(vadduser_OBJECTS) $(vadduser_LDADD) $(LIBS)
-valias$(EXEEXT): $(valias_OBJECTS) $(valias_DEPENDENCIES) 
-	@rm -f valias$(EXEEXT)
-	$(LINK) $(valias_LDFLAGS) $(valias_OBJECTS) $(valias_LDADD) $(LIBS)
-vchangepw$(EXEEXT): $(vchangepw_OBJECTS) $(vchangepw_DEPENDENCIES) 
-	@rm -f vchangepw$(EXEEXT)
-	$(LINK) $(vchangepw_LDFLAGS) $(vchangepw_OBJECTS) $(vchangepw_LDADD) $(LIBS)
-vchkpw$(EXEEXT): $(vchkpw_OBJECTS) $(vchkpw_DEPENDENCIES) 
-	@rm -f vchkpw$(EXEEXT)
-	$(LINK) $(vchkpw_LDFLAGS) $(vchkpw_OBJECTS) $(vchkpw_LDADD) $(LIBS)
-vconvert$(EXEEXT): $(vconvert_OBJECTS) $(vconvert_DEPENDENCIES) 
-	@rm -f vconvert$(EXEEXT)
-	$(LINK) $(vconvert_LDFLAGS) $(vconvert_OBJECTS) $(vconvert_LDADD) $(LIBS)
-vdeldomain$(EXEEXT): $(vdeldomain_OBJECTS) $(vdeldomain_DEPENDENCIES) 
-	@rm -f vdeldomain$(EXEEXT)
+
+vdeldomain: $(vdeldomain_OBJECTS) $(vdeldomain_DEPENDENCIES)
+	@rm -f vdeldomain
 	$(LINK) $(vdeldomain_LDFLAGS) $(vdeldomain_OBJECTS) $(vdeldomain_LDADD) $(LIBS)
-vdelivermail$(EXEEXT): $(vdelivermail_OBJECTS) $(vdelivermail_DEPENDENCIES) 
-	@rm -f vdelivermail$(EXEEXT)
-	$(LINK) $(vdelivermail_LDFLAGS) $(vdelivermail_OBJECTS) $(vdelivermail_LDADD) $(LIBS)
-vdeloldusers$(EXEEXT): $(vdeloldusers_OBJECTS) $(vdeloldusers_DEPENDENCIES) 
-	@rm -f vdeloldusers$(EXEEXT)
-	$(LINK) $(vdeloldusers_LDFLAGS) $(vdeloldusers_OBJECTS) $(vdeloldusers_LDADD) $(LIBS)
-vdeluser$(EXEEXT): $(vdeluser_OBJECTS) $(vdeluser_DEPENDENCIES) 
-	@rm -f vdeluser$(EXEEXT)
-	$(LINK) $(vdeluser_LDFLAGS) $(vdeluser_OBJECTS) $(vdeluser_LDADD) $(LIBS)
-vdominfo$(EXEEXT): $(vdominfo_OBJECTS) $(vdominfo_DEPENDENCIES) 
-	@rm -f vdominfo$(EXEEXT)
-	$(LINK) $(vdominfo_LDFLAGS) $(vdominfo_OBJECTS) $(vdominfo_LDADD) $(LIBS)
-vipmap$(EXEEXT): $(vipmap_OBJECTS) $(vipmap_DEPENDENCIES) 
-	@rm -f vipmap$(EXEEXT)
-	$(LINK) $(vipmap_LDFLAGS) $(vipmap_OBJECTS) $(vipmap_LDADD) $(LIBS)
-vkill$(EXEEXT): $(vkill_OBJECTS) $(vkill_DEPENDENCIES) 
-	@rm -f vkill$(EXEEXT)
-	$(LINK) $(vkill_LDFLAGS) $(vkill_OBJECTS) $(vkill_LDADD) $(LIBS)
-vmkpasswd$(EXEEXT): $(vmkpasswd_OBJECTS) $(vmkpasswd_DEPENDENCIES) 
-	@rm -f vmkpasswd$(EXEEXT)
-	$(LINK) $(vmkpasswd_LDFLAGS) $(vmkpasswd_OBJECTS) $(vmkpasswd_LDADD) $(LIBS)
-vmoddomlimits$(EXEEXT): $(vmoddomlimits_OBJECTS) $(vmoddomlimits_DEPENDENCIES) 
-	@rm -f vmoddomlimits$(EXEEXT)
-	$(LINK) $(vmoddomlimits_LDFLAGS) $(vmoddomlimits_OBJECTS) $(vmoddomlimits_LDADD) $(LIBS)
-vmoduser$(EXEEXT): $(vmoduser_OBJECTS) $(vmoduser_DEPENDENCIES) 
-	@rm -f vmoduser$(EXEEXT)
-	$(LINK) $(vmoduser_LDFLAGS) $(vmoduser_OBJECTS) $(vmoduser_LDADD) $(LIBS)
-vpasswd$(EXEEXT): $(vpasswd_OBJECTS) $(vpasswd_DEPENDENCIES) 
-	@rm -f vpasswd$(EXEEXT)
+
+vpasswd: $(vpasswd_OBJECTS) $(vpasswd_DEPENDENCIES)
+	@rm -f vpasswd
 	$(LINK) $(vpasswd_LDFLAGS) $(vpasswd_OBJECTS) $(vpasswd_LDADD) $(LIBS)
-vpopbull$(EXEEXT): $(vpopbull_OBJECTS) $(vpopbull_DEPENDENCIES) 
-	@rm -f vpopbull$(EXEEXT)
-	$(LINK) $(vpopbull_LDFLAGS) $(vpopbull_OBJECTS) $(vpopbull_LDADD) $(LIBS)
-vsetuserquota$(EXEEXT): $(vsetuserquota_OBJECTS) $(vsetuserquota_DEPENDENCIES) 
-	@rm -f vsetuserquota$(EXEEXT)
+
+vadduser: $(vadduser_OBJECTS) $(vadduser_DEPENDENCIES)
+	@rm -f vadduser
+	$(LINK) $(vadduser_LDFLAGS) $(vadduser_OBJECTS) $(vadduser_LDADD) $(LIBS)
+
+vdeluser: $(vdeluser_OBJECTS) $(vdeluser_DEPENDENCIES)
+	@rm -f vdeluser
+	$(LINK) $(vdeluser_LDFLAGS) $(vdeluser_OBJECTS) $(vdeluser_LDADD) $(LIBS)
+
+vaddaliasdomain: $(vaddaliasdomain_OBJECTS) $(vaddaliasdomain_DEPENDENCIES)
+	@rm -f vaddaliasdomain
+	$(LINK) $(vaddaliasdomain_LDFLAGS) $(vaddaliasdomain_OBJECTS) $(vaddaliasdomain_LDADD) $(LIBS)
+
+vsetuserquota: $(vsetuserquota_OBJECTS) $(vsetuserquota_DEPENDENCIES)
+	@rm -f vsetuserquota
 	$(LINK) $(vsetuserquota_LDFLAGS) $(vsetuserquota_OBJECTS) $(vsetuserquota_LDADD) $(LIBS)
-vuserinfo$(EXEEXT): $(vuserinfo_OBJECTS) $(vuserinfo_DEPENDENCIES) 
-	@rm -f vuserinfo$(EXEEXT)
+
+vpopbull: $(vpopbull_OBJECTS) $(vpopbull_DEPENDENCIES)
+	@rm -f vpopbull
+	$(LINK) $(vpopbull_LDFLAGS) $(vpopbull_OBJECTS) $(vpopbull_LDADD) $(LIBS)
+
+vdeloldusers: $(vdeloldusers_OBJECTS) $(vdeloldusers_DEPENDENCIES)
+	@rm -f vdeloldusers
+	$(LINK) $(vdeloldusers_LDFLAGS) $(vdeloldusers_OBJECTS) $(vdeloldusers_LDADD) $(LIBS)
+
+vmoduser: $(vmoduser_OBJECTS) $(vmoduser_DEPENDENCIES)
+	@rm -f vmoduser
+	$(LINK) $(vmoduser_LDFLAGS) $(vmoduser_OBJECTS) $(vmoduser_LDADD) $(LIBS)
+
+valias: $(valias_OBJECTS) $(valias_DEPENDENCIES)
+	@rm -f valias
+	$(LINK) $(valias_LDFLAGS) $(valias_OBJECTS) $(valias_LDADD) $(LIBS)
+
+vuserinfo: $(vuserinfo_OBJECTS) $(vuserinfo_DEPENDENCIES)
+	@rm -f vuserinfo
 	$(LINK) $(vuserinfo_LDFLAGS) $(vuserinfo_OBJECTS) $(vuserinfo_LDADD) $(LIBS)
 
-mostlyclean-compile:
-	-rm -f *.$(OBJEXT) core *.core
+vmkpasswd: $(vmkpasswd_OBJECTS) $(vmkpasswd_DEPENDENCIES)
+	@rm -f vmkpasswd
+	$(LINK) $(vmkpasswd_LDFLAGS) $(vmkpasswd_OBJECTS) $(vmkpasswd_LDADD) $(LIBS)
 
-distclean-compile:
-	-rm -f *.tab.c
+vipmap: $(vipmap_OBJECTS) $(vipmap_DEPENDENCIES)
+	@rm -f vipmap
+	$(LINK) $(vipmap_LDFLAGS) $(vipmap_OBJECTS) $(vipmap_LDADD) $(LIBS)
 
-.c.o:
-	$(COMPILE) -c `test -f '$<' || echo '$(srcdir)/'`$<
+vdominfo: $(vdominfo_OBJECTS) $(vdominfo_DEPENDENCIES)
+	@rm -f vdominfo
+	$(LINK) $(vdominfo_LDFLAGS) $(vdominfo_OBJECTS) $(vdominfo_LDADD) $(LIBS)
 
-.c.obj:
-	$(COMPILE) -c `cygpath -w $<`
-uninstall-info-am:
+vconvert: $(vconvert_OBJECTS) $(vconvert_DEPENDENCIES)
+	@rm -f vconvert
+	$(LINK) $(vconvert_LDFLAGS) $(vconvert_OBJECTS) $(vconvert_LDADD) $(LIBS)
+
+vkill: $(vkill_OBJECTS) $(vkill_DEPENDENCIES)
+	@rm -f vkill
+	$(LINK) $(vkill_LDFLAGS) $(vkill_OBJECTS) $(vkill_LDADD) $(LIBS)
+
+vmoddomlimits: $(vmoddomlimits_OBJECTS) $(vmoddomlimits_DEPENDENCIES)
+	@rm -f vmoddomlimits
+	$(LINK) $(vmoddomlimits_LDFLAGS) $(vmoddomlimits_OBJECTS) $(vmoddomlimits_LDADD) $(LIBS)
+
+vchangepw: $(vchangepw_OBJECTS) $(vchangepw_DEPENDENCIES)
+	@rm -f vchangepw
+	$(LINK) $(vchangepw_LDFLAGS) $(vchangepw_OBJECTS) $(vchangepw_LDADD) $(LIBS)
+
+dotqmail2valias: $(dotqmail2valias_OBJECTS) $(dotqmail2valias_DEPENDENCIES)
+	@rm -f dotqmail2valias
+	$(LINK) $(dotqmail2valias_LDFLAGS) $(dotqmail2valias_OBJECTS) $(dotqmail2valias_LDADD) $(LIBS)
 
 # This directory's subdirectories are mostly independent; you can cd
 # into them and run `make' without going through this Makefile.
@@ -493,8 +472,13 @@
 # (1) if the variable is set in `config.status', edit `config.status'
 #     (which will cause the Makefiles to be regenerated when you run `make');
 # (2) otherwise, pass the desired values on the `make' command line.
-$(RECURSIVE_TARGETS):
-	@set fnord $$MAKEFLAGS; amf=$$2; \
+
+@SET_MAKE@
+
+all-recursive install-data-recursive install-exec-recursive \
+installdirs-recursive install-recursive uninstall-recursive  \
+check-recursive installcheck-recursive info-recursive dvi-recursive:
+	@set fnord $(MAKEFLAGS); amf=$$2; \
 	dot_seen=no; \
 	target=`echo $@ | sed s/-recursive//`; \
 	list='$(SUBDIRS)'; for subdir in $$list; do \
@@ -514,18 +498,13 @@
 
 mostlyclean-recursive clean-recursive distclean-recursive \
 maintainer-clean-recursive:
-	@set fnord $$MAKEFLAGS; amf=$$2; \
+	@set fnord $(MAKEFLAGS); amf=$$2; \
 	dot_seen=no; \
-	case "$@" in \
-	  distclean-* | maintainer-clean-*) list='$(DIST_SUBDIRS)' ;; \
-	  *) list='$(SUBDIRS)' ;; \
-	esac; \
-	rev=''; for subdir in $$list; do \
-	  if test "$$subdir" = "."; then :; else \
-	    rev="$$subdir $$rev"; \
-	  fi; \
+	rev=''; list='$(SUBDIRS)'; for subdir in $$list; do \
+	  rev="$$subdir $$rev"; \
+	  test "$$subdir" = "." && dot_seen=yes; \
 	done; \
-	rev="$$rev ."; \
+	test "$$dot_seen" = "no" && rev=". $$rev"; \
 	target=`echo $@ | sed s/-recursive//`; \
 	for subdir in $$rev; do \
 	  echo "Making $$target in $$subdir"; \
@@ -542,237 +521,189 @@
 	  test "$$subdir" = . || (cd $$subdir && $(MAKE) $(AM_MAKEFLAGS) tags); \
 	done
 
-ETAGS = etags
-ETAGSFLAGS =
-
 tags: TAGS
 
-ID: $(HEADERS) $(SOURCES) $(LISP) $(TAGS_FILES)
-	list='$(SOURCES) $(HEADERS) $(LISP) $(TAGS_FILES)'; \
-	unique=`for i in $$list; do \
-	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
-	  done | \
-	  $(AWK) '    { files[$$0] = 1; } \
+ID: $(HEADERS) $(SOURCES) $(LISP)
+	list='$(SOURCES) $(HEADERS)'; \
+	unique=`for i in $$list; do echo $$i; done | \
+	  awk '    { files[$$0] = 1; } \
 	       END { for (i in files) print i; }'`; \
-	mkid -fID $$unique
+	here=`pwd` && cd $(srcdir) \
+	  && mkid -f$$here/ID $$unique $(LISP)
 
-TAGS: tags-recursive $(HEADERS) $(SOURCES) config.h.in $(TAGS_DEPENDENCIES) \
-		$(TAGS_FILES) $(LISP)
+TAGS: tags-recursive $(HEADERS) $(SOURCES) config.h.in $(TAGS_DEPENDENCIES) $(LISP)
 	tags=; \
 	here=`pwd`; \
 	list='$(SUBDIRS)'; for subdir in $$list; do \
-	  if test "$$subdir" = .; then :; else \
+   if test "$$subdir" = .; then :; else \
 	    test -f $$subdir/TAGS && tags="$$tags -i $$here/$$subdir/TAGS"; \
-	  fi; \
+   fi; \
 	done; \
-	list='$(SOURCES) $(HEADERS) config.h.in $(LISP) $(TAGS_FILES)'; \
-	unique=`for i in $$list; do \
-	    if test -f "$$i"; then echo $$i; else echo $(srcdir)/$$i; fi; \
-	  done | \
-	  $(AWK) '    { files[$$0] = 1; } \
+	list='$(SOURCES) $(HEADERS)'; \
+	unique=`for i in $$list; do echo $$i; done | \
+	  awk '    { files[$$0] = 1; } \
 	       END { for (i in files) print i; }'`; \
-	test -z "$(ETAGS_ARGS)$$tags$$unique" \
-	  || $(ETAGS) $(ETAGSFLAGS) $(AM_ETAGSFLAGS) $(ETAGS_ARGS) \
-	     $$tags $$unique
-
-GTAGS:
-	here=`$(am__cd) $(top_builddir) && pwd` \
-	  && cd $(top_srcdir) \
-	  && gtags -i $(GTAGS_ARGS) $$here
+	test -z "$(ETAGS_ARGS)config.h.in$$unique$(LISP)$$tags" \
+	  || (cd $(srcdir) && etags $(ETAGS_ARGS) $$tags config.h.in $$unique $(LISP) -o $$here/TAGS)
 
-distclean-tags:
-	-rm -f TAGS ID GTAGS GRTAGS GSYMS GPATH
-DISTFILES = $(DIST_COMMON) $(DIST_SOURCES) $(TEXINFOS) $(EXTRA_DIST)
+mostlyclean-tags:
 
-top_distdir = .
-distdir = $(PACKAGE)-$(VERSION)
+clean-tags:
 
-am__remove_distdir = \
-  { test ! -d $(distdir) \
-    || { find $(distdir) -type d ! -perm -200 -exec chmod u+w {} ';' \
-         && rm -fr $(distdir); }; }
+distclean-tags:
+	-rm -f TAGS ID
 
-GZIP_ENV = --best
-distcleancheck_listfiles = find . -type f -print
+maintainer-clean-tags:
 
+distdir = $(PACKAGE)-$(VERSION)
+top_distdir = $(distdir)
+
+# This target untars the dist file and tries a VPATH configuration.  Then
+# it guarantees that the distribution is self-contained by making another
+# tarfile.
+distcheck: dist
+	-rm -rf $(distdir)
+	GZIP=$(GZIP_ENV) $(TAR) zxf $(distdir).tar.gz
+	mkdir $(distdir)/=build
+	mkdir $(distdir)/=inst
+	dc_install_base=`cd $(distdir)/=inst && pwd`; \
+	cd $(distdir)/=build \
+	  && ../configure --srcdir=.. --prefix=$$dc_install_base \
+	  && $(MAKE) $(AM_MAKEFLAGS) \
+	  && $(MAKE) $(AM_MAKEFLAGS) dvi \
+	  && $(MAKE) $(AM_MAKEFLAGS) check \
+	  && $(MAKE) $(AM_MAKEFLAGS) install \
+	  && $(MAKE) $(AM_MAKEFLAGS) installcheck \
+	  && $(MAKE) $(AM_MAKEFLAGS) dist
+	-rm -rf $(distdir)
+	@banner="$(distdir).tar.gz is ready for distribution"; \
+	dashes=`echo "$$banner" | sed s/./=/g`; \
+	echo "$$dashes"; \
+	echo "$$banner"; \
+	echo "$$dashes"
+dist: distdir
+	-chmod -R a+r $(distdir)
+	GZIP=$(GZIP_ENV) $(TAR) chozf $(distdir).tar.gz $(distdir)
+	-rm -rf $(distdir)
+dist-all: distdir
+	-chmod -R a+r $(distdir)
+	GZIP=$(GZIP_ENV) $(TAR) chozf $(distdir).tar.gz $(distdir)
+	-rm -rf $(distdir)
 distdir: $(DISTFILES)
-	$(am__remove_distdir)
+	-rm -rf $(distdir)
 	mkdir $(distdir)
-	@list='$(DISTFILES)'; for file in $$list; do \
-	  if test -f $$file || test -d $$file; then d=.; else d=$(srcdir); fi; \
-	  dir=`echo "$$file" | sed -e 's,/[^/]*$$,,'`; \
-	  if test "$$dir" != "$$file" && test "$$dir" != "."; then \
-	    dir="/$$dir"; \
-	    $(mkinstalldirs) "$(distdir)$$dir"; \
-	  else \
-	    dir=''; \
-	  fi; \
+	-chmod 777 $(distdir)
+	@for file in $(DISTFILES); do \
+	  d=$(srcdir); \
 	  if test -d $$d/$$file; then \
-	    if test -d $(srcdir)/$$file && test $$d != $(srcdir); then \
-	      cp -pR $(srcdir)/$$file $(distdir)$$dir || exit 1; \
-	    fi; \
-	    cp -pR $$d/$$file $(distdir)$$dir || exit 1; \
+	    cp -pr $$d/$$file $(distdir)/$$file; \
 	  else \
 	    test -f $(distdir)/$$file \
-	    || cp -p $$d/$$file $(distdir)/$$file \
-	    || exit 1; \
+	    || ln $$d/$$file $(distdir)/$$file 2> /dev/null \
+	    || cp -p $$d/$$file $(distdir)/$$file || :; \
 	  fi; \
 	done
-	list='$(SUBDIRS)'; for subdir in $$list; do \
+	for subdir in $(SUBDIRS); do \
 	  if test "$$subdir" = .; then :; else \
 	    test -d $(distdir)/$$subdir \
 	    || mkdir $(distdir)/$$subdir \
 	    || exit 1; \
-	    (cd $$subdir && \
-	      $(MAKE) $(AM_MAKEFLAGS) \
-	        top_distdir="$(top_distdir)" \
-	        distdir=../$(distdir)/$$subdir \
-	        distdir) \
+	    chmod 777 $(distdir)/$$subdir; \
+	    (cd $$subdir && $(MAKE) $(AM_MAKEFLAGS) top_distdir=../$(distdir) distdir=../$(distdir)/$$subdir distdir) \
 	      || exit 1; \
 	  fi; \
 	done
-	-find $(distdir) -type d ! -perm -777 -exec chmod a+rwx {} \; -o \
-	  ! -type d ! -perm -444 -links 1 -exec chmod a+r {} \; -o \
-	  ! -type d ! -perm -400 -exec chmod a+r {} \; -o \
-	  ! -type d ! -perm -444 -exec $(SHELL) $(install_sh) -c -m a+r {} {} \; \
-	|| chmod -R a+r $(distdir)
-dist-gzip: distdir
-	$(AMTAR) chof - $(distdir) | GZIP=$(GZIP_ENV) gzip -c >$(distdir).tar.gz
-	$(am__remove_distdir)
-
-dist dist-all: distdir
-	$(AMTAR) chof - $(distdir) | GZIP=$(GZIP_ENV) gzip -c >$(distdir).tar.gz
-	$(am__remove_distdir)
-
-# This target untars the dist file and tries a VPATH configuration.  Then
-# it guarantees that the distribution is self-contained by making another
-# tarfile.
-distcheck: dist
-	$(am__remove_distdir)
-	GZIP=$(GZIP_ENV) gunzip -c $(distdir).tar.gz | $(AMTAR) xf -
-	chmod -R a-w $(distdir); chmod a+w $(distdir)
-	mkdir $(distdir)/=build
-	mkdir $(distdir)/=inst
-	chmod a-w $(distdir)
-	dc_install_base=`$(am__cd) $(distdir)/=inst && pwd` \
-	  && cd $(distdir)/=build \
-	  && ../configure --srcdir=.. --prefix=$$dc_install_base \
-	    $(DISTCHECK_CONFIGURE_FLAGS) \
-	  && $(MAKE) $(AM_MAKEFLAGS) \
-	  && $(MAKE) $(AM_MAKEFLAGS) dvi \
-	  && $(MAKE) $(AM_MAKEFLAGS) check \
-	  && $(MAKE) $(AM_MAKEFLAGS) install \
-	  && $(MAKE) $(AM_MAKEFLAGS) installcheck \
-	  && $(MAKE) $(AM_MAKEFLAGS) uninstall \
-	  && (test `find $$dc_install_base -type f -print | wc -l` -le 1 \
-	      || { echo "ERROR: files left after uninstall:" ; \
-	           find $$dc_install_base -type f -print ; \
-	           exit 1; } >&2 ) \
-	  && $(MAKE) $(AM_MAKEFLAGS) dist-gzip \
-	  && rm -f $(distdir).tar.gz \
-	  && $(MAKE) $(AM_MAKEFLAGS) distcleancheck
-	$(am__remove_distdir)
-	@echo "$(distdir).tar.gz is ready for distribution" | \
-	  sed 'h;s/./=/g;p;x;p;x'
-distcleancheck: distclean
-	if test '$(srcdir)' = . ; then \
-	  echo "ERROR: distcleancheck can only run from a VPATH build" ; \
-	  exit 1 ; \
-	fi
-	test `$(distcleancheck_listfiles) | wc -l` -eq 0 \
-	  || { echo "ERROR: files left after distclean:" ; \
-	       $(distcleancheck_listfiles) ; \
-	       exit 1; } >&2
+info-am:
+info: info-recursive
+dvi-am:
+dvi: dvi-recursive
 check-am: all-am
 check: check-recursive
-all-am: Makefile $(LIBRARIES) $(PROGRAMS) config.h
-installdirs: installdirs-recursive
-installdirs-am:
-	$(mkinstalldirs) $(DESTDIR)$(vpopmailbindir)
+installcheck-am:
+installcheck: installcheck-recursive
+all-recursive-am: config.h
+	$(MAKE) $(AM_MAKEFLAGS) all-recursive
 
-install: install-recursive
+install-exec-am:
 install-exec: install-exec-recursive
+
+install-data-am: install-vpopmailbinPROGRAMS install-data-local
 install-data: install-data-recursive
-uninstall: uninstall-recursive
 
 install-am: all-am
 	@$(MAKE) $(AM_MAKEFLAGS) install-exec-am install-data-am
-
-installcheck: installcheck-recursive
+install: install-recursive
+uninstall-am: uninstall-vpopmailbinPROGRAMS
+uninstall: uninstall-recursive
+all-am: Makefile $(LIBRARIES) $(PROGRAMS) config.h
+all-redirect: all-recursive-am
 install-strip:
-	$(MAKE) $(AM_MAKEFLAGS) INSTALL_PROGRAM="$(INSTALL_STRIP_PROGRAM)" \
-	  INSTALL_STRIP_FLAG=-s \
-	  `test -z '$(STRIP)' || \
-	    echo "INSTALL_PROGRAM_ENV=STRIPPROG='$(STRIP)'"` install
+	$(MAKE) $(AM_MAKEFLAGS) AM_INSTALL_PROGRAM_FLAGS=-s install
+installdirs: installdirs-recursive
+installdirs-am:
+	$(mkinstalldirs)  $(DESTDIR)$(vpopmailbindir)
+
+
 mostlyclean-generic:
 
 clean-generic:
 
 distclean-generic:
 	-rm -f Makefile $(CONFIG_CLEAN_FILES)
+	-rm -f config.cache config.log stamp-h stamp-h[0-9]*
 
 maintainer-clean-generic:
-	@echo "This command is intended for maintainers to use"
-	@echo "it deletes files that may require special tools to rebuild."
-clean: clean-recursive
-
-clean-am: clean-generic clean-noinstLIBRARIES clean-vpopmailbinPROGRAMS \
-	mostlyclean-am
+mostlyclean-am:  mostlyclean-hdr mostlyclean-noinstLIBRARIES \
+		mostlyclean-compile mostlyclean-vpopmailbinPROGRAMS \
+		mostlyclean-tags mostlyclean-generic
 
-distclean: distclean-recursive
-	-rm -f $(am__CONFIG_DISTCLEAN_FILES)
-distclean-am: clean-am distclean-compile distclean-generic distclean-hdr \
-	distclean-tags
-
-dvi: dvi-recursive
-
-dvi-am:
-
-info: info-recursive
-
-info-am:
+mostlyclean: mostlyclean-recursive
 
-install-data-am: install-data-local install-vpopmailbinPROGRAMS
+clean-am:  clean-hdr clean-noinstLIBRARIES clean-compile \
+		clean-vpopmailbinPROGRAMS clean-tags clean-generic \
+		mostlyclean-am
 
-install-exec-am:
+clean: clean-recursive
 
-install-info: install-info-recursive
+distclean-am:  distclean-hdr distclean-noinstLIBRARIES distclean-compile \
+		distclean-vpopmailbinPROGRAMS distclean-tags \
+		distclean-generic clean-am
 
-install-man:
+distclean: distclean-recursive
+	-rm -f config.status
 
-installcheck-am:
+maintainer-clean-am:  maintainer-clean-hdr \
+		maintainer-clean-noinstLIBRARIES \
+		maintainer-clean-compile \
+		maintainer-clean-vpopmailbinPROGRAMS \
+		maintainer-clean-tags maintainer-clean-generic \
+		distclean-am
+	@echo "This command is intended for maintainers to use;"
+	@echo "it deletes files that may require special tools to rebuild."
 
 maintainer-clean: maintainer-clean-recursive
-	-rm -f $(am__CONFIG_DISTCLEAN_FILES)
-	-rm -rf autom4te.cache
-maintainer-clean-am: distclean-am maintainer-clean-generic
+	-rm -f config.status
 
-mostlyclean: mostlyclean-recursive
-
-mostlyclean-am: mostlyclean-compile mostlyclean-generic
-
-uninstall-am: uninstall-info-am uninstall-vpopmailbinPROGRAMS
-
-uninstall-info: uninstall-info-recursive
-
-.PHONY: $(RECURSIVE_TARGETS) GTAGS all all-am check check-am clean \
-	clean-generic clean-noinstLIBRARIES clean-recursive \
-	clean-vpopmailbinPROGRAMS dist dist-all dist-gzip distcheck \
-	distclean distclean-compile distclean-generic distclean-hdr \
-	distclean-recursive distclean-tags distcleancheck distdir dvi \
-	dvi-am dvi-recursive info info-am info-recursive install \
-	install-am install-data install-data-am install-data-local \
-	install-data-recursive install-exec install-exec-am \
-	install-exec-recursive install-info install-info-am \
-	install-info-recursive install-man install-recursive \
-	install-strip install-vpopmailbinPROGRAMS installcheck \
-	installcheck-am installdirs installdirs-am \
-	installdirs-recursive maintainer-clean maintainer-clean-generic \
-	maintainer-clean-recursive mostlyclean mostlyclean-compile \
-	mostlyclean-generic mostlyclean-recursive tags tags-recursive \
-	uninstall uninstall-am uninstall-info-am \
-	uninstall-info-recursive uninstall-recursive \
-	uninstall-vpopmailbinPROGRAMS
+.PHONY: mostlyclean-hdr distclean-hdr clean-hdr maintainer-clean-hdr \
+mostlyclean-noinstLIBRARIES distclean-noinstLIBRARIES \
+clean-noinstLIBRARIES maintainer-clean-noinstLIBRARIES \
+mostlyclean-compile distclean-compile clean-compile \
+maintainer-clean-compile mostlyclean-vpopmailbinPROGRAMS \
+distclean-vpopmailbinPROGRAMS clean-vpopmailbinPROGRAMS \
+maintainer-clean-vpopmailbinPROGRAMS uninstall-vpopmailbinPROGRAMS \
+install-vpopmailbinPROGRAMS install-data-recursive \
+uninstall-data-recursive install-exec-recursive \
+uninstall-exec-recursive installdirs-recursive uninstalldirs-recursive \
+all-recursive check-recursive installcheck-recursive info-recursive \
+dvi-recursive mostlyclean-recursive distclean-recursive clean-recursive \
+maintainer-clean-recursive tags tags-recursive mostlyclean-tags \
+distclean-tags clean-tags maintainer-clean-tags distdir info-am info \
+dvi-am dvi check check-am installcheck-am installcheck all-recursive-am \
+install-exec-am install-exec install-data-local install-data-am \
+install-data install-am install uninstall-am uninstall all-redirect \
+all-am all installdirs-am installdirs mostlyclean-generic \
+distclean-generic clean-generic maintainer-clean-generic clean \
+mostlyclean distclean maintainer-clean
 
 
 @SET_MAKE@
@@ -854,6 +785,7 @@
 	chmod 700 $(DESTDIR)@vpopmaildir@/@domains_dir@
 	chown -R @vpopuser@  $(DESTDIR)@vpopmaildir@/@domains_dir@
 	chgrp -R @vpopgroup@ $(DESTDIR)@vpopmaildir@/@domains_dir@
+
 # Tell versions [3.59,3.63) of GNU make to not export all variables.
 # Otherwise a system limit (for SysV at least) may be exceeded.
 .NOEXPORT:
diff -urN ../vpopmail-5.4.10/aclocal.m4 ./aclocal.m4
--- ../vpopmail-5.4.10/aclocal.m4	Sun Mar 20 07:38:35 2005
+++ ./aclocal.m4	Thu Apr 28 12:35:59 2005
@@ -1,311 +1,93 @@
-# aclocal.m4 generated automatically by aclocal 1.6.3 -*- Autoconf -*-
+dnl aclocal.m4 generated automatically by aclocal 1.4-p4
 
-# Copyright 1996, 1997, 1998, 1999, 2000, 2001, 2002
-# Free Software Foundation, Inc.
-# This file is free software; the Free Software Foundation
-# gives unlimited permission to copy and/or distribute it,
-# with or without modifications, as long as this notice is preserved.
-
-# This program is distributed in the hope that it will be useful,
-# but WITHOUT ANY WARRANTY, to the extent permitted by law; without
-# even the implied warranty of MERCHANTABILITY or FITNESS FOR A
-# PARTICULAR PURPOSE.
-
-# Like AC_CONFIG_HEADER, but automatically create stamp file. -*- Autoconf -*-
-
-# Copyright 1996, 1997, 2000, 2001 Free Software Foundation, Inc.
-
-# This program is free software; you can redistribute it and/or modify
-# it under the terms of the GNU General Public License as published by
-# the Free Software Foundation; either version 2, or (at your option)
-# any later version.
-
-# This program is distributed in the hope that it will be useful,
-# but WITHOUT ANY WARRANTY; without even the implied warranty of
-# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
-# GNU General Public License for more details.
-
-# You should have received a copy of the GNU General Public License
-# along with this program; if not, write to the Free Software
-# Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA
-# 02111-1307, USA.
-
-AC_PREREQ([2.52])
-
-# serial 6
-
-# When config.status generates a header, we must update the stamp-h file.
-# This file resides in the same directory as the config header
-# that is generated.  We must strip everything past the first ":",
-# and everything past the last "/".
-
-# _AM_DIRNAME(PATH)
-# -----------------
-# Like AS_DIRNAME, only do it during macro expansion
-AC_DEFUN([_AM_DIRNAME],
-       [m4_if(regexp([$1], [^.*[^/]//*[^/][^/]*/*$]), -1,
-	      m4_if(regexp([$1], [^//\([^/]\|$\)]), -1,
-		    m4_if(regexp([$1], [^/.*]), -1,
-			  [.],
-			  patsubst([$1], [^\(/\).*], [\1])),
-		    patsubst([$1], [^\(//\)\([^/].*\|$\)], [\1])),
-	      patsubst([$1], [^\(.*[^/]\)//*[^/][^/]*/*$], [\1]))[]dnl
-])# _AM_DIRNAME
-
-
-# The stamp files are numbered to have different names.
-# We could number them on a directory basis, but that's additional
-# complications, let's have a unique counter.
-m4_define([_AM_STAMP_Count], [0])
-
-
-# _AM_STAMP(HEADER)
-# -----------------
-# The name of the stamp file for HEADER.
-AC_DEFUN([_AM_STAMP],
-[m4_define([_AM_STAMP_Count], m4_incr(_AM_STAMP_Count))dnl
-AS_ESCAPE(_AM_DIRNAME(patsubst([$1],
-                               [:.*])))/stamp-h[]_AM_STAMP_Count])
-
-
-# _AM_CONFIG_HEADER(HEADER[:SOURCES], COMMANDS, INIT-COMMANDS)
-# ------------------------------------------------------------
-# We used to try to get a real timestamp in stamp-h.  But the fear is that
-# that will cause unnecessary cvs conflicts.
-AC_DEFUN([_AM_CONFIG_HEADER],
-[# Add the stamp file to the list of files AC keeps track of,
-# along with our hook.
-AC_CONFIG_HEADERS([$1],
-                  [# update the timestamp
-echo 'timestamp for $1' >"_AM_STAMP([$1])"
-$2],
-                  [$3])
-])# _AM_CONFIG_HEADER
-
-
-# AM_CONFIG_HEADER(HEADER[:SOURCES]..., COMMANDS, INIT-COMMANDS)
-# --------------------------------------------------------------
-AC_DEFUN([AM_CONFIG_HEADER],
-[AC_FOREACH([_AM_File], [$1], [_AM_CONFIG_HEADER(_AM_File, [$2], [$3])])
-])# AM_CONFIG_HEADER
-
-# Do all the work for Automake.                            -*- Autoconf -*-
-
-# This macro actually does too much some checks are only needed if
-# your package does certain things.  But this isn't really a big deal.
-
-# Copyright 1996, 1997, 1998, 1999, 2000, 2001, 2002
-# Free Software Foundation, Inc.
-
-# This program is free software; you can redistribute it and/or modify
-# it under the terms of the GNU General Public License as published by
-# the Free Software Foundation; either version 2, or (at your option)
-# any later version.
-
-# This program is distributed in the hope that it will be useful,
-# but WITHOUT ANY WARRANTY; without even the implied warranty of
-# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
-# GNU General Public License for more details.
-
-# You should have received a copy of the GNU General Public License
-# along with this program; if not, write to the Free Software
-# Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA
-# 02111-1307, USA.
-
-# serial 8
-
-# There are a few dirty hacks below to avoid letting `AC_PROG_CC' be
-# written in clear, in which case automake, when reading aclocal.m4,
-# will think it sees a *use*, and therefore will trigger all it's
-# C support machinery.  Also note that it means that autoscan, seeing
-# CC etc. in the Makefile, will ask for an AC_PROG_CC use...
-
-
-AC_PREREQ([2.52])
-
-# Autoconf 2.50 wants to disallow AM_ names.  We explicitly allow
-# the ones we care about.
-m4_pattern_allow([^AM_[A-Z]+FLAGS$])dnl
-
-# AM_INIT_AUTOMAKE(PACKAGE, VERSION, [NO-DEFINE])
-# AM_INIT_AUTOMAKE([OPTIONS])
-# -----------------------------------------------
-# The call with PACKAGE and VERSION arguments is the old style
-# call (pre autoconf-2.50), which is being phased out.  PACKAGE
-# and VERSION should now be passed to AC_INIT and removed from
-# the call to AM_INIT_AUTOMAKE.
-# We support both call styles for the transition.  After
-# the next Automake release, Autoconf can make the AC_INIT
-# arguments mandatory, and then we can depend on a new Autoconf
-# release and drop the old call support.
-AC_DEFUN([AM_INIT_AUTOMAKE],
-[AC_REQUIRE([AM_SET_CURRENT_AUTOMAKE_VERSION])dnl
- AC_REQUIRE([AC_PROG_INSTALL])dnl
-# test to see if srcdir already configured
-if test "`cd $srcdir && pwd`" != "`pwd`" &&
-   test -f $srcdir/config.status; then
+dnl Copyright (C) 1994, 1995-8, 1999 Free Software Foundation, Inc.
+dnl This file is free software; the Free Software Foundation
+dnl gives unlimited permission to copy and/or distribute it,
+dnl with or without modifications, as long as this notice is preserved.
+
+dnl This program is distributed in the hope that it will be useful,
+dnl but WITHOUT ANY WARRANTY, to the extent permitted by law; without
+dnl even the implied warranty of MERCHANTABILITY or FITNESS FOR A
+dnl PARTICULAR PURPOSE.
+
+# Like AC_CONFIG_HEADER, but automatically create stamp file.
+
+AC_DEFUN(AM_CONFIG_HEADER,
+[AC_PREREQ([2.12])
+AC_CONFIG_HEADER([$1])
+dnl When config.status generates a header, we must update the stamp-h file.
+dnl This file resides in the same directory as the config header
+dnl that is generated.  We must strip everything past the first ":",
+dnl and everything past the last "/".
+AC_OUTPUT_COMMANDS(changequote(<<,>>)dnl
+ifelse(patsubst(<<$1>>, <<[^ ]>>, <<>>), <<>>,
+<<test -z "<<$>>CONFIG_HEADERS" || echo timestamp > patsubst(<<$1>>, <<^\([^:]*/\)?.*>>, <<\1>>)stamp-h<<>>dnl>>,
+<<am_indx=1
+for am_file in <<$1>>; do
+  case " <<$>>CONFIG_HEADERS " in
+  *" <<$>>am_file "*<<)>>
+    echo timestamp > `echo <<$>>am_file | sed -e 's%:.*%%' -e 's%[^/]*$%%'`stamp-h$am_indx
+    ;;
+  esac
+  am_indx=`expr "<<$>>am_indx" + 1`
+done<<>>dnl>>)
+changequote([,]))])
+
+# Do all the work for Automake.  This macro actually does too much --
+# some checks are only needed if your package does certain things.
+# But this isn't really a big deal.
+
+# serial 1
+
+dnl Usage:
+dnl AM_INIT_AUTOMAKE(package,version, [no-define])
+
+AC_DEFUN(AM_INIT_AUTOMAKE,
+[AC_REQUIRE([AC_PROG_INSTALL])
+PACKAGE=[$1]
+AC_SUBST(PACKAGE)
+VERSION=[$2]
+AC_SUBST(VERSION)
+dnl test to see if srcdir already configured
+if test "`cd $srcdir && pwd`" != "`pwd`" && test -f $srcdir/config.status; then
   AC_MSG_ERROR([source directory already configured; run "make distclean" there first])
 fi
-
-# Define the identity of the package.
-dnl Distinguish between old-style and new-style calls.
-m4_ifval([$2],
-[m4_ifval([$3], [_AM_SET_OPTION([no-define])])dnl
- AC_SUBST([PACKAGE], [$1])dnl
- AC_SUBST([VERSION], [$2])],
-[_AM_SET_OPTIONS([$1])dnl
- AC_SUBST([PACKAGE], [AC_PACKAGE_TARNAME])dnl
- AC_SUBST([VERSION], [AC_PACKAGE_VERSION])])dnl
-
-_AM_IF_OPTION([no-define],,
-[AC_DEFINE_UNQUOTED(PACKAGE, "$PACKAGE", [Name of package])
- AC_DEFINE_UNQUOTED(VERSION, "$VERSION", [Version number of package])])dnl
-
-# Some tools Automake needs.
-AC_REQUIRE([AM_SANITY_CHECK])dnl
-AC_REQUIRE([AC_ARG_PROGRAM])dnl
-AM_MISSING_PROG(ACLOCAL, aclocal)
-AM_MISSING_PROG(AUTOCONF, autoconf)
-AM_MISSING_PROG(AUTOMAKE, automake)
-AM_MISSING_PROG(AUTOHEADER, autoheader)
-AM_MISSING_PROG(MAKEINFO, makeinfo)
-AM_MISSING_PROG(AMTAR, tar)
-AM_PROG_INSTALL_SH
-AM_PROG_INSTALL_STRIP
-# We need awk for the "check" target.  The system "awk" is bad on
-# some platforms.
-AC_REQUIRE([AC_PROG_AWK])dnl
-AC_REQUIRE([AC_PROG_MAKE_SET])dnl
-
-_AM_IF_OPTION([no-dependencies],,
-[AC_PROVIDE_IFELSE([AC_PROG_][CC],
-                  [_AM_DEPENDENCIES(CC)],
-                  [define([AC_PROG_][CC],
-                          defn([AC_PROG_][CC])[_AM_DEPENDENCIES(CC)])])dnl
-AC_PROVIDE_IFELSE([AC_PROG_][CXX],
-                  [_AM_DEPENDENCIES(CXX)],
-                  [define([AC_PROG_][CXX],
-                          defn([AC_PROG_][CXX])[_AM_DEPENDENCIES(CXX)])])dnl
-])
-])
-
-# Copyright 2002  Free Software Foundation, Inc.
-
-# This program is free software; you can redistribute it and/or modify
-# it under the terms of the GNU General Public License as published by
-# the Free Software Foundation; either version 2, or (at your option)
-# any later version.
-
-# This program is distributed in the hope that it will be useful,
-# but WITHOUT ANY WARRANTY; without even the implied warranty of
-# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
-# GNU General Public License for more details.
-
-# You should have received a copy of the GNU General Public License
-# along with this program; if not, write to the Free Software
-# Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA
-
-# AM_AUTOMAKE_VERSION(VERSION)
-# ----------------------------
-# Automake X.Y traces this macro to ensure aclocal.m4 has been
-# generated from the m4 files accompanying Automake X.Y.
-AC_DEFUN([AM_AUTOMAKE_VERSION],[am__api_version="1.6"])
-
-# AM_SET_CURRENT_AUTOMAKE_VERSION
-# -------------------------------
-# Call AM_AUTOMAKE_VERSION so it can be traced.
-# This function is AC_REQUIREd by AC_INIT_AUTOMAKE.
-AC_DEFUN([AM_SET_CURRENT_AUTOMAKE_VERSION],
-	 [AM_AUTOMAKE_VERSION([1.6.3])])
-
-# Helper functions for option handling.                    -*- Autoconf -*-
-
-# Copyright 2001, 2002  Free Software Foundation, Inc.
-
-# This program is free software; you can redistribute it and/or modify
-# it under the terms of the GNU General Public License as published by
-# the Free Software Foundation; either version 2, or (at your option)
-# any later version.
-
-# This program is distributed in the hope that it will be useful,
-# but WITHOUT ANY WARRANTY; without even the implied warranty of
-# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
-# GNU General Public License for more details.
-
-# You should have received a copy of the GNU General Public License
-# along with this program; if not, write to the Free Software
-# Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA
-# 02111-1307, USA.
-
-# serial 2
-
-# _AM_MANGLE_OPTION(NAME)
-# -----------------------
-AC_DEFUN([_AM_MANGLE_OPTION],
-[[_AM_OPTION_]m4_bpatsubst($1, [[^a-zA-Z0-9_]], [_])])
-
-# _AM_SET_OPTION(NAME)
-# ------------------------------
-# Set option NAME.  Presently that only means defining a flag for this option.
-AC_DEFUN([_AM_SET_OPTION],
-[m4_define(_AM_MANGLE_OPTION([$1]), 1)])
-
-# _AM_SET_OPTIONS(OPTIONS)
-# ----------------------------------
-# OPTIONS is a space-separated list of Automake options.
-AC_DEFUN([_AM_SET_OPTIONS],
-[AC_FOREACH([_AM_Option], [$1], [_AM_SET_OPTION(_AM_Option)])])
-
-# _AM_IF_OPTION(OPTION, IF-SET, [IF-NOT-SET])
-# -------------------------------------------
-# Execute IF-SET if OPTION is set, IF-NOT-SET otherwise.
-AC_DEFUN([_AM_IF_OPTION],
-[m4_ifset(_AM_MANGLE_OPTION([$1]), [$2], [$3])])
+ifelse([$3],,
+AC_DEFINE_UNQUOTED(PACKAGE, "$PACKAGE", [Name of package])
+AC_DEFINE_UNQUOTED(VERSION, "$VERSION", [Version number of package]))
+AC_REQUIRE([AM_SANITY_CHECK])
+AC_REQUIRE([AC_ARG_PROGRAM])
+dnl FIXME This is truly gross.
+missing_dir=`cd $ac_aux_dir && pwd`
+AM_MISSING_PROG(ACLOCAL, aclocal, $missing_dir)
+AM_MISSING_PROG(AUTOCONF, autoconf, $missing_dir)
+AM_MISSING_PROG(AUTOMAKE, automake, $missing_dir)
+AM_MISSING_PROG(AUTOHEADER, autoheader, $missing_dir)
+AM_MISSING_PROG(MAKEINFO, makeinfo, $missing_dir)
+AC_REQUIRE([AC_PROG_MAKE_SET])])
 
 #
 # Check to make sure that the build environment is sane.
 #
 
-# Copyright 1996, 1997, 2000, 2001 Free Software Foundation, Inc.
-
-# This program is free software; you can redistribute it and/or modify
-# it under the terms of the GNU General Public License as published by
-# the Free Software Foundation; either version 2, or (at your option)
-# any later version.
-
-# This program is distributed in the hope that it will be useful,
-# but WITHOUT ANY WARRANTY; without even the implied warranty of
-# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
-# GNU General Public License for more details.
-
-# You should have received a copy of the GNU General Public License
-# along with this program; if not, write to the Free Software
-# Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA
-# 02111-1307, USA.
-
-# serial 3
-
-# AM_SANITY_CHECK
-# ---------------
-AC_DEFUN([AM_SANITY_CHECK],
+AC_DEFUN(AM_SANITY_CHECK,
 [AC_MSG_CHECKING([whether build environment is sane])
 # Just in case
 sleep 1
-echo timestamp > conftest.file
+echo timestamp > conftestfile
 # Do `set' in a subshell so we don't clobber the current shell's
 # arguments.  Must try -L first in case configure is actually a
 # symlink; some systems play weird games with the mod time of symlinks
 # (eg FreeBSD returns the mod time of the symlink's containing
 # directory).
 if (
-   set X `ls -Lt $srcdir/configure conftest.file 2> /dev/null`
-   if test "$[*]" = "X"; then
+   set X `ls -Lt $srcdir/configure conftestfile 2> /dev/null`
+   if test "[$]*" = "X"; then
       # -L didn't work.
-      set X `ls -t $srcdir/configure conftest.file`
+      set X `ls -t $srcdir/configure conftestfile`
    fi
-   rm -f conftest.file
-   if test "$[*]" != "X $srcdir/configure conftest.file" \
-      && test "$[*]" != "X conftest.file $srcdir/configure"; then
+   if test "[$]*" != "X $srcdir/configure conftestfile" \
+      && test "[$]*" != "X conftestfile $srcdir/configure"; then
 
       # If neither matched, then we have a broken ls.  This can happen
       # if, for instance, CONFIG_SHELL is bash and it inherits a
@@ -315,7 +97,7 @@
 alias in your environment])
    fi
 
-   test "$[2]" = conftest.file
+   test "[$]2" = conftestfile
    )
 then
    # Ok.
@@ -324,515 +106,24 @@
    AC_MSG_ERROR([newly created file is older than distributed files!
 Check your system clock])
 fi
+rm -f conftest*
 AC_MSG_RESULT(yes)])
 
-#  -*- Autoconf -*-
-
-
-# Copyright 1997, 1999, 2000, 2001 Free Software Foundation, Inc.
-
-# This program is free software; you can redistribute it and/or modify
-# it under the terms of the GNU General Public License as published by
-# the Free Software Foundation; either version 2, or (at your option)
-# any later version.
-
-# This program is distributed in the hope that it will be useful,
-# but WITHOUT ANY WARRANTY; without even the implied warranty of
-# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
-# GNU General Public License for more details.
-
-# You should have received a copy of the GNU General Public License
-# along with this program; if not, write to the Free Software
-# Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA
-# 02111-1307, USA.
-
-# serial 3
-
-# AM_MISSING_PROG(NAME, PROGRAM)
-# ------------------------------
-AC_DEFUN([AM_MISSING_PROG],
-[AC_REQUIRE([AM_MISSING_HAS_RUN])
-$1=${$1-"${am_missing_run}$2"}
-AC_SUBST($1)])
-
-
-# AM_MISSING_HAS_RUN
-# ------------------
-# Define MISSING if not defined so far and test if it supports --run.
-# If it does, set am_missing_run to use it, otherwise, to nothing.
-AC_DEFUN([AM_MISSING_HAS_RUN],
-[AC_REQUIRE([AM_AUX_DIR_EXPAND])dnl
-test x"${MISSING+set}" = xset || MISSING="\${SHELL} $am_aux_dir/missing"
-# Use eval to expand $SHELL
-if eval "$MISSING --run true"; then
-  am_missing_run="$MISSING --run "
+dnl AM_MISSING_PROG(NAME, PROGRAM, DIRECTORY)
+dnl The program must properly implement --version.
+AC_DEFUN(AM_MISSING_PROG,
+[AC_MSG_CHECKING(for working $2)
+# Run test in a subshell; some versions of sh will print an error if
+# an executable is not found, even if stderr is redirected.
+# Redirect stdin to placate older versions of autoconf.  Sigh.
+if ($2 --version) < /dev/null > /dev/null 2>&1; then
+   $1=$2
+   AC_MSG_RESULT(found)
 else
-  am_missing_run=
-  AC_MSG_WARN([`missing' script is too old or missing])
+   $1="$3/missing $2"
+   AC_MSG_RESULT(missing)
 fi
-])
-
-# AM_AUX_DIR_EXPAND
-
-# Copyright 2001 Free Software Foundation, Inc.
-
-# This program is free software; you can redistribute it and/or modify
-# it under the terms of the GNU General Public License as published by
-# the Free Software Foundation; either version 2, or (at your option)
-# any later version.
-
-# This program is distributed in the hope that it will be useful,
-# but WITHOUT ANY WARRANTY; without even the implied warranty of
-# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
-# GNU General Public License for more details.
-
-# You should have received a copy of the GNU General Public License
-# along with this program; if not, write to the Free Software
-# Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA
-# 02111-1307, USA.
-
-# For projects using AC_CONFIG_AUX_DIR([foo]), Autoconf sets
-# $ac_aux_dir to `$srcdir/foo'.  In other projects, it is set to
-# `$srcdir', `$srcdir/..', or `$srcdir/../..'.
-#
-# Of course, Automake must honor this variable whenever it calls a
-# tool from the auxiliary directory.  The problem is that $srcdir (and
-# therefore $ac_aux_dir as well) can be either absolute or relative,
-# depending on how configure is run.  This is pretty annoying, since
-# it makes $ac_aux_dir quite unusable in subdirectories: in the top
-# source directory, any form will work fine, but in subdirectories a
-# relative path needs to be adjusted first.
-#
-# $ac_aux_dir/missing
-#    fails when called from a subdirectory if $ac_aux_dir is relative
-# $top_srcdir/$ac_aux_dir/missing
-#    fails if $ac_aux_dir is absolute,
-#    fails when called from a subdirectory in a VPATH build with
-#          a relative $ac_aux_dir
-#
-# The reason of the latter failure is that $top_srcdir and $ac_aux_dir
-# are both prefixed by $srcdir.  In an in-source build this is usually
-# harmless because $srcdir is `.', but things will broke when you
-# start a VPATH build or use an absolute $srcdir.
-#
-# So we could use something similar to $top_srcdir/$ac_aux_dir/missing,
-# iff we strip the leading $srcdir from $ac_aux_dir.  That would be:
-#   am_aux_dir='\$(top_srcdir)/'`expr "$ac_aux_dir" : "$srcdir//*\(.*\)"`
-# and then we would define $MISSING as
-#   MISSING="\${SHELL} $am_aux_dir/missing"
-# This will work as long as MISSING is not called from configure, because
-# unfortunately $(top_srcdir) has no meaning in configure.
-# However there are other variables, like CC, which are often used in
-# configure, and could therefore not use this "fixed" $ac_aux_dir.
-#
-# Another solution, used here, is to always expand $ac_aux_dir to an
-# absolute PATH.  The drawback is that using absolute paths prevent a
-# configured tree to be moved without reconfiguration.
-
-# Rely on autoconf to set up CDPATH properly.
-AC_PREREQ([2.50])
-
-AC_DEFUN([AM_AUX_DIR_EXPAND], [
-# expand $ac_aux_dir to an absolute path
-am_aux_dir=`cd $ac_aux_dir && pwd`
-])
-
-# AM_PROG_INSTALL_SH
-# ------------------
-# Define $install_sh.
-
-# Copyright 2001 Free Software Foundation, Inc.
-
-# This program is free software; you can redistribute it and/or modify
-# it under the terms of the GNU General Public License as published by
-# the Free Software Foundation; either version 2, or (at your option)
-# any later version.
-
-# This program is distributed in the hope that it will be useful,
-# but WITHOUT ANY WARRANTY; without even the implied warranty of
-# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
-# GNU General Public License for more details.
-
-# You should have received a copy of the GNU General Public License
-# along with this program; if not, write to the Free Software
-# Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA
-# 02111-1307, USA.
-
-AC_DEFUN([AM_PROG_INSTALL_SH],
-[AC_REQUIRE([AM_AUX_DIR_EXPAND])dnl
-install_sh=${install_sh-"$am_aux_dir/install-sh"}
-AC_SUBST(install_sh)])
-
-# AM_PROG_INSTALL_STRIP
-
-# Copyright 2001 Free Software Foundation, Inc.
-
-# This program is free software; you can redistribute it and/or modify
-# it under the terms of the GNU General Public License as published by
-# the Free Software Foundation; either version 2, or (at your option)
-# any later version.
-
-# This program is distributed in the hope that it will be useful,
-# but WITHOUT ANY WARRANTY; without even the implied warranty of
-# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
-# GNU General Public License for more details.
-
-# You should have received a copy of the GNU General Public License
-# along with this program; if not, write to the Free Software
-# Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA
-# 02111-1307, USA.
-
-# One issue with vendor `install' (even GNU) is that you can't
-# specify the program used to strip binaries.  This is especially
-# annoying in cross-compiling environments, where the build's strip
-# is unlikely to handle the host's binaries.
-# Fortunately install-sh will honor a STRIPPROG variable, so we
-# always use install-sh in `make install-strip', and initialize
-# STRIPPROG with the value of the STRIP variable (set by the user).
-AC_DEFUN([AM_PROG_INSTALL_STRIP],
-[AC_REQUIRE([AM_PROG_INSTALL_SH])dnl
-# Installed binaries are usually stripped using `strip' when the user
-# run `make install-strip'.  However `strip' might not be the right
-# tool to use in cross-compilation environments, therefore Automake
-# will honor the `STRIP' environment variable to overrule this program.
-dnl Don't test for $cross_compiling = yes, because it might be `maybe'.
-if test "$cross_compiling" != no; then
-  AC_CHECK_TOOL([STRIP], [strip], :)
-fi
-INSTALL_STRIP_PROGRAM="\${SHELL} \$(install_sh) -c -s"
-AC_SUBST([INSTALL_STRIP_PROGRAM])])
-
-# serial 4						-*- Autoconf -*-
-
-# Copyright 1999, 2000, 2001 Free Software Foundation, Inc.
-
-# This program is free software; you can redistribute it and/or modify
-# it under the terms of the GNU General Public License as published by
-# the Free Software Foundation; either version 2, or (at your option)
-# any later version.
-
-# This program is distributed in the hope that it will be useful,
-# but WITHOUT ANY WARRANTY; without even the implied warranty of
-# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
-# GNU General Public License for more details.
-
-# You should have received a copy of the GNU General Public License
-# along with this program; if not, write to the Free Software
-# Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA
-# 02111-1307, USA.
-
-
-# There are a few dirty hacks below to avoid letting `AC_PROG_CC' be
-# written in clear, in which case automake, when reading aclocal.m4,
-# will think it sees a *use*, and therefore will trigger all it's
-# C support machinery.  Also note that it means that autoscan, seeing
-# CC etc. in the Makefile, will ask for an AC_PROG_CC use...
-
-
-
-# _AM_DEPENDENCIES(NAME)
-# ----------------------
-# See how the compiler implements dependency checking.
-# NAME is "CC", "CXX", "GCJ", or "OBJC".
-# We try a few techniques and use that to set a single cache variable.
-#
-# We don't AC_REQUIRE the corresponding AC_PROG_CC since the latter was
-# modified to invoke _AM_DEPENDENCIES(CC); we would have a circular
-# dependency, and given that the user is not expected to run this macro,
-# just rely on AC_PROG_CC.
-AC_DEFUN([_AM_DEPENDENCIES],
-[AC_REQUIRE([AM_SET_DEPDIR])dnl
-AC_REQUIRE([AM_OUTPUT_DEPENDENCY_COMMANDS])dnl
-AC_REQUIRE([AM_MAKE_INCLUDE])dnl
-AC_REQUIRE([AM_DEP_TRACK])dnl
-
-ifelse([$1], CC,   [depcc="$CC"   am_compiler_list=],
-       [$1], CXX,  [depcc="$CXX"  am_compiler_list=],
-       [$1], OBJC, [depcc="$OBJC" am_compiler_list='gcc3 gcc'],
-       [$1], GCJ,  [depcc="$GCJ"  am_compiler_list='gcc3 gcc'],
-                   [depcc="$$1"   am_compiler_list=])
-
-AC_CACHE_CHECK([dependency style of $depcc],
-               [am_cv_$1_dependencies_compiler_type],
-[if test -z "$AMDEP_TRUE" && test -f "$am_depcomp"; then
-  # We make a subdir and do the tests there.  Otherwise we can end up
-  # making bogus files that we don't know about and never remove.  For
-  # instance it was reported that on HP-UX the gcc test will end up
-  # making a dummy file named `D' -- because `-MD' means `put the output
-  # in D'.
-  mkdir conftest.dir
-  # Copy depcomp to subdir because otherwise we won't find it if we're
-  # using a relative directory.
-  cp "$am_depcomp" conftest.dir
-  cd conftest.dir
-
-  am_cv_$1_dependencies_compiler_type=none
-  if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n ['s/^#*\([a-zA-Z0-9]*\))$/\1/p'] < ./depcomp`
-  fi
-  for depmode in $am_compiler_list; do
-    # We need to recreate these files for each test, as the compiler may
-    # overwrite some of them when testing with obscure command lines.
-    # This happens at least with the AIX C compiler.
-    echo '#include "conftest.h"' > conftest.c
-    echo 'int i;' > conftest.h
-    echo "${am__include} ${am__quote}conftest.Po${am__quote}" > confmf
-
-    case $depmode in
-    nosideeffect)
-      # after this tag, mechanisms are not by side-effect, so they'll
-      # only be used when explicitly requested
-      if test "x$enable_dependency_tracking" = xyes; then
-	continue
-      else
-	break
-      fi
-      ;;
-    none) break ;;
-    esac
-    # We check with `-c' and `-o' for the sake of the "dashmstdout"
-    # mode.  It turns out that the SunPro C++ compiler does not properly
-    # handle `-M -o', and we need to detect this.
-    if depmode=$depmode \
-       source=conftest.c object=conftest.o \
-       depfile=conftest.Po tmpdepfile=conftest.TPo \
-       $SHELL ./depcomp $depcc -c conftest.c -o conftest.o >/dev/null 2>&1 &&
-       grep conftest.h conftest.Po > /dev/null 2>&1 &&
-       ${MAKE-make} -s -f confmf > /dev/null 2>&1; then
-      am_cv_$1_dependencies_compiler_type=$depmode
-      break
-    fi
-  done
-
-  cd ..
-  rm -rf conftest.dir
-else
-  am_cv_$1_dependencies_compiler_type=none
-fi
-])
-AC_SUBST([$1DEPMODE], [depmode=$am_cv_$1_dependencies_compiler_type])
-])
-
-
-# AM_SET_DEPDIR
-# -------------
-# Choose a directory name for dependency files.
-# This macro is AC_REQUIREd in _AM_DEPENDENCIES
-AC_DEFUN([AM_SET_DEPDIR],
-[rm -f .deps 2>/dev/null
-mkdir .deps 2>/dev/null
-if test -d .deps; then
-  DEPDIR=.deps
-else
-  # MS-DOS does not allow filenames that begin with a dot.
-  DEPDIR=_deps
-fi
-rmdir .deps 2>/dev/null
-AC_SUBST([DEPDIR])
-])
-
-
-# AM_DEP_TRACK
-# ------------
-AC_DEFUN([AM_DEP_TRACK],
-[AC_ARG_ENABLE(dependency-tracking,
-[  --disable-dependency-tracking Speeds up one-time builds
-  --enable-dependency-tracking  Do not reject slow dependency extractors])
-if test "x$enable_dependency_tracking" != xno; then
-  am_depcomp="$ac_aux_dir/depcomp"
-  AMDEPBACKSLASH='\'
-fi
-AM_CONDITIONAL([AMDEP], [test "x$enable_dependency_tracking" != xno])
-AC_SUBST([AMDEPBACKSLASH])
-])
-
-# Generate code to set up dependency tracking.   -*- Autoconf -*-
-
-# Copyright 1999, 2000, 2001, 2002 Free Software Foundation, Inc.
-
-# This program is free software; you can redistribute it and/or modify
-# it under the terms of the GNU General Public License as published by
-# the Free Software Foundation; either version 2, or (at your option)
-# any later version.
-
-# This program is distributed in the hope that it will be useful,
-# but WITHOUT ANY WARRANTY; without even the implied warranty of
-# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
-# GNU General Public License for more details.
-
-# You should have received a copy of the GNU General Public License
-# along with this program; if not, write to the Free Software
-# Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA
-# 02111-1307, USA.
-
-#serial 2
-
-# _AM_OUTPUT_DEPENDENCY_COMMANDS
-# ------------------------------
-AC_DEFUN([_AM_OUTPUT_DEPENDENCY_COMMANDS],
-[for mf in $CONFIG_FILES; do
-  # Strip MF so we end up with the name of the file.
-  mf=`echo "$mf" | sed -e 's/:.*$//'`
-  # Check whether this is an Automake generated Makefile or not.
-  # We used to match only the files named `Makefile.in', but
-  # some people rename them; so instead we look at the file content.
-  # Grep'ing the first line is not enough: some people post-process
-  # each Makefile.in and add a new line on top of each file to say so.
-  # So let's grep whole file.
-  if grep '^#.*generated by automake' $mf > /dev/null 2>&1; then
-    dirpart=`AS_DIRNAME("$mf")`
-  else
-    continue
-  fi
-  grep '^DEP_FILES *= *[[^ @%:@]]' < "$mf" > /dev/null || continue
-  # Extract the definition of DEP_FILES from the Makefile without
-  # running `make'.
-  DEPDIR=`sed -n -e '/^DEPDIR = / s///p' < "$mf"`
-  test -z "$DEPDIR" && continue
-  # When using ansi2knr, U may be empty or an underscore; expand it
-  U=`sed -n -e '/^U = / s///p' < "$mf"`
-  test -d "$dirpart/$DEPDIR" || mkdir "$dirpart/$DEPDIR"
-  # We invoke sed twice because it is the simplest approach to
-  # changing $(DEPDIR) to its actual value in the expansion.
-  for file in `sed -n -e '
-    /^DEP_FILES = .*\\\\$/ {
-      s/^DEP_FILES = //
-      :loop
-	s/\\\\$//
-	p
-	n
-	/\\\\$/ b loop
-      p
-    }
-    /^DEP_FILES = / s/^DEP_FILES = //p' < "$mf" | \
-       sed -e 's/\$(DEPDIR)/'"$DEPDIR"'/g' -e 's/\$U/'"$U"'/g'`; do
-    # Make sure the directory exists.
-    test -f "$dirpart/$file" && continue
-    fdir=`AS_DIRNAME(["$file"])`
-    AS_MKDIR_P([$dirpart/$fdir])
-    # echo "creating $dirpart/$file"
-    echo '# dummy' > "$dirpart/$file"
-  done
-done
-])# _AM_OUTPUT_DEPENDENCY_COMMANDS
-
-
-# AM_OUTPUT_DEPENDENCY_COMMANDS
-# -----------------------------
-# This macro should only be invoked once -- use via AC_REQUIRE.
-#
-# This code is only required when automatic dependency tracking
-# is enabled.  FIXME.  This creates each `.P' file that we will
-# need in order to bootstrap the dependency handling code.
-AC_DEFUN([AM_OUTPUT_DEPENDENCY_COMMANDS],
-[AC_CONFIG_COMMANDS([depfiles],
-     [test x"$AMDEP_TRUE" != x"" || _AM_OUTPUT_DEPENDENCY_COMMANDS],
-     [AMDEP_TRUE="$AMDEP_TRUE" ac_aux_dir="$ac_aux_dir"])
-])
-
-# Copyright 2001 Free Software Foundation, Inc.             -*- Autoconf -*-
-
-# This program is free software; you can redistribute it and/or modify
-# it under the terms of the GNU General Public License as published by
-# the Free Software Foundation; either version 2, or (at your option)
-# any later version.
-
-# This program is distributed in the hope that it will be useful,
-# but WITHOUT ANY WARRANTY; without even the implied warranty of
-# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
-# GNU General Public License for more details.
-
-# You should have received a copy of the GNU General Public License
-# along with this program; if not, write to the Free Software
-# Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA
-# 02111-1307, USA.
-
-# serial 2
-
-# AM_MAKE_INCLUDE()
-# -----------------
-# Check to see how make treats includes.
-AC_DEFUN([AM_MAKE_INCLUDE],
-[am_make=${MAKE-make}
-cat > confinc << 'END'
-doit:
-	@echo done
-END
-# If we don't find an include directive, just comment out the code.
-AC_MSG_CHECKING([for style of include used by $am_make])
-am__include="#"
-am__quote=
-_am_result=none
-# First try GNU make style include.
-echo "include confinc" > confmf
-# We grep out `Entering directory' and `Leaving directory'
-# messages which can occur if `w' ends up in MAKEFLAGS.
-# In particular we don't look at `^make:' because GNU make might
-# be invoked under some other name (usually "gmake"), in which
-# case it prints its new name instead of `make'.
-if test "`$am_make -s -f confmf 2> /dev/null | fgrep -v 'ing directory'`" = "done"; then
-   am__include=include
-   am__quote=
-   _am_result=GNU
-fi
-# Now try BSD make style include.
-if test "$am__include" = "#"; then
-   echo '.include "confinc"' > confmf
-   if test "`$am_make -s -f confmf 2> /dev/null`" = "done"; then
-      am__include=.include
-      am__quote="\""
-      _am_result=BSD
-   fi
-fi
-AC_SUBST(am__include)
-AC_SUBST(am__quote)
-AC_MSG_RESULT($_am_result)
-rm -f confinc confmf
-])
-
-# AM_CONDITIONAL                                              -*- Autoconf -*-
-
-# Copyright 1997, 2000, 2001 Free Software Foundation, Inc.
-
-# This program is free software; you can redistribute it and/or modify
-# it under the terms of the GNU General Public License as published by
-# the Free Software Foundation; either version 2, or (at your option)
-# any later version.
-
-# This program is distributed in the hope that it will be useful,
-# but WITHOUT ANY WARRANTY; without even the implied warranty of
-# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
-# GNU General Public License for more details.
-
-# You should have received a copy of the GNU General Public License
-# along with this program; if not, write to the Free Software
-# Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA
-# 02111-1307, USA.
-
-# serial 5
-
-AC_PREREQ(2.52)
-
-# AM_CONDITIONAL(NAME, SHELL-CONDITION)
-# -------------------------------------
-# Define a conditional.
-AC_DEFUN([AM_CONDITIONAL],
-[ifelse([$1], [TRUE],  [AC_FATAL([$0: invalid condition: $1])],
-        [$1], [FALSE], [AC_FATAL([$0: invalid condition: $1])])dnl
-AC_SUBST([$1_TRUE])
-AC_SUBST([$1_FALSE])
-if $2; then
-  $1_TRUE=
-  $1_FALSE='#'
-else
-  $1_TRUE='#'
-  $1_FALSE=
-fi
-AC_CONFIG_COMMANDS_PRE(
-[if test -z "${$1_TRUE}" && test -z "${$1_FALSE}"; then
-  AC_MSG_ERROR([conditional \"$1\" was never defined.
-Usually this means the macro was only invoked conditionally.])
-fi])])
+AC_SUBST($1)])
 
 #serial 1
 # This test replaces the one in autoconf.
diff -urN ../vpopmail-5.4.10/config.h.in ./config.h.in
--- ../vpopmail-5.4.10/config.h.in	Sun Mar 20 07:38:35 2005
+++ ./config.h.in	Thu Apr 28 12:35:59 2005
@@ -256,6 +256,12 @@
 #undef RETSIGTYPE
 
 /* "" */
+#undef SPAMASSASSIN
+
+/* "" */
+#undef SPAMC_PROG
+
+/* "" */
 #undef SQWEBMAIL_PASS
 
 /* Define to 1 if you have the ANSI C header files. */
diff -urN ../vpopmail-5.4.10/configure ./configure
--- ../vpopmail-5.4.10/configure	Sun Mar 20 07:38:35 2005
+++ ./configure	Thu Apr 28 12:35:59 2005
@@ -832,8 +832,6 @@
 Optional Features:
   --disable-FEATURE       do not include FEATURE (same as --enable-FEATURE=no)
   --enable-FEATURE[=ARG]  include FEATURE [ARG=yes]
-  --disable-dependency-tracking Speeds up one-time builds
-  --enable-dependency-tracking  Do not reject slow dependency extractors
   --enable-qmaildir=DIR      Directory where qmail control and user directories are installed /var/qmail.
   --enable-qmail-newu=PATH   Full path to qmail-newu program.
   --enable-qmail-inject=PATH Full path to qmail-inject program.
@@ -855,6 +853,8 @@
   --enable-sqwebmail-pass    Store a copy of the user's password in the the user's maildir for use by pre-v3 sqwebmail.
   --enable-qmail-ext         Enable qmail email address extension support.
   --enable-ip-alias-domains  Enable mapping of default domain via reverse ip lookup table.
+  --enable-spamassassin      Enable spamassassin. See  README.spamassassin for more info.
+  --enable-spamc-prog=PATH    Full path to spamc program /usr/{local/}bin/spamc.
   --enable-domainquotas      Enable non-system domain quotas. See README.quotas for more info.
   --enable-domains-dir=TEXT  Set domains directory name for ~vpopmail/domains/user/.
   --enable-incdir=DIR        Your MySQL/Oracle 'include' directory.
@@ -1241,13 +1241,11 @@
 PACKAGE=$PACKAGE_NAME
 VERSION=$PACKAGE_VERSION
 
-# Add the stamp file to the list of files AC keeps track of,
-# along with our hook.
-ac_config_headers="$ac_config_headers config.h"
 
+ac_config_headers="$ac_config_headers config.h"
 
+ac_config_commands="$ac_config_commands default-1"
 
-am__api_version="1.6"
 ac_aux_dir=
 for ac_dir in $srcdir $srcdir/.. $srcdir/../..; do
   if test -f $ac_dir/install-sh; then
@@ -1354,21 +1352,20 @@
 echo $ECHO_N "checking whether build environment is sane... $ECHO_C" >&6
 # Just in case
 sleep 1
-echo timestamp > conftest.file
+echo timestamp > conftestfile
 # Do `set' in a subshell so we don't clobber the current shell's
 # arguments.  Must try -L first in case configure is actually a
 # symlink; some systems play weird games with the mod time of symlinks
 # (eg FreeBSD returns the mod time of the symlink's containing
 # directory).
 if (
-   set X `ls -Lt $srcdir/configure conftest.file 2> /dev/null`
+   set X `ls -Lt $srcdir/configure conftestfile 2> /dev/null`
    if test "$*" = "X"; then
       # -L didn't work.
-      set X `ls -t $srcdir/configure conftest.file`
+      set X `ls -t $srcdir/configure conftestfile`
    fi
-   rm -f conftest.file
-   if test "$*" != "X $srcdir/configure conftest.file" \
-      && test "$*" != "X conftest.file $srcdir/configure"; then
+   if test "$*" != "X $srcdir/configure conftestfile" \
+      && test "$*" != "X conftestfile $srcdir/configure"; then
 
       # If neither matched, then we have a broken ls.  This can happen
       # if, for instance, CONFIG_SHELL is bash and it inherits a
@@ -1381,7 +1378,7 @@
    { (exit 1); exit 1; }; }
    fi
 
-   test "$2" = conftest.file
+   test "$2" = conftestfile
    )
 then
    # Ok.
@@ -1393,6 +1390,7 @@
 Check your system clock" >&2;}
    { (exit 1); exit 1; }; }
 fi
+rm -f conftest*
 echo "$as_me:$LINENO: result: yes" >&5
 echo "${ECHO_T}yes" >&6
 test "$program_prefix" != NONE &&
@@ -1408,60 +1406,6 @@
 program_transform_name=`echo $program_transform_name | sed -f conftest.sed`
 rm conftest.sed
 
-
-# expand $ac_aux_dir to an absolute path
-am_aux_dir=`cd $ac_aux_dir && pwd`
-
-test x"${MISSING+set}" = xset || MISSING="\${SHELL} $am_aux_dir/missing"
-# Use eval to expand $SHELL
-if eval "$MISSING --run true"; then
-  am_missing_run="$MISSING --run "
-else
-  am_missing_run=
-  { echo "$as_me:$LINENO: WARNING: \`missing' script is too old or missing" >&5
-echo "$as_me: WARNING: \`missing' script is too old or missing" >&2;}
-fi
-
-for ac_prog in gawk mawk nawk awk
-do
-  # Extract the first word of "$ac_prog", so it can be a program name with args.
-set dummy $ac_prog; ac_word=$2
-echo "$as_me:$LINENO: checking for $ac_word" >&5
-echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6
-if test "${ac_cv_prog_AWK+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  if test -n "$AWK"; then
-  ac_cv_prog_AWK="$AWK" # Let the user override the test.
-else
-as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-  for ac_exec_ext in '' $ac_executable_extensions; do
-  if $as_executable_p "$as_dir/$ac_word$ac_exec_ext"; then
-    ac_cv_prog_AWK="$ac_prog"
-    echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
-    break 2
-  fi
-done
-done
-
-fi
-fi
-AWK=$ac_cv_prog_AWK
-if test -n "$AWK"; then
-  echo "$as_me:$LINENO: result: $AWK" >&5
-echo "${ECHO_T}$AWK" >&6
-else
-  echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6
-fi
-
-  test -n "$AWK" && break
-done
-
 echo "$as_me:$LINENO: checking whether ${MAKE-make} sets \${MAKE}" >&5
 echo $ECHO_N "checking whether ${MAKE-make} sets \${MAKE}... $ECHO_C" >&6
 set dummy ${MAKE-make}; ac_make=`echo "$2" | sed 'y,./+-,__p_,'`
@@ -1491,19 +1435,17 @@
   SET_MAKE="MAKE=${MAKE-make}"
 fi
 
- # test to see if srcdir already configured
-if test "`cd $srcdir && pwd`" != "`pwd`" &&
-   test -f $srcdir/config.status; then
+
+PACKAGE=
+
+VERSION=
+
+if test "`cd $srcdir && pwd`" != "`pwd`" && test -f $srcdir/config.status; then
   { { echo "$as_me:$LINENO: error: source directory already configured; run \"make distclean\" there first" >&5
 echo "$as_me: error: source directory already configured; run \"make distclean\" there first" >&2;}
    { (exit 1); exit 1; }; }
 fi
 
-# Define the identity of the package.
- PACKAGE=vpopmail
- VERSION=5.4.10
-
-
 cat >>confdefs.h <<_ACEOF
 #define PACKAGE "$PACKAGE"
 _ACEOF
@@ -1513,118 +1455,83 @@
 #define VERSION "$VERSION"
 _ACEOF
 
-# Some tools Automake needs.
-
-ACLOCAL=${ACLOCAL-"${am_missing_run}aclocal"}
-
-
-AUTOCONF=${AUTOCONF-"${am_missing_run}autoconf"}
-
-
-AUTOMAKE=${AUTOMAKE-"${am_missing_run}automake"}
-
-
-AUTOHEADER=${AUTOHEADER-"${am_missing_run}autoheader"}
-
-
-MAKEINFO=${MAKEINFO-"${am_missing_run}makeinfo"}
-
-
-AMTAR=${AMTAR-"${am_missing_run}tar"}
-
-install_sh=${install_sh-"$am_aux_dir/install-sh"}
 
-# Installed binaries are usually stripped using `strip' when the user
-# run `make install-strip'.  However `strip' might not be the right
-# tool to use in cross-compilation environments, therefore Automake
-# will honor the `STRIP' environment variable to overrule this program.
-if test "$cross_compiling" != no; then
-  if test -n "$ac_tool_prefix"; then
-  # Extract the first word of "${ac_tool_prefix}strip", so it can be a program name with args.
-set dummy ${ac_tool_prefix}strip; ac_word=$2
-echo "$as_me:$LINENO: checking for $ac_word" >&5
-echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6
-if test "${ac_cv_prog_STRIP+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  if test -n "$STRIP"; then
-  ac_cv_prog_STRIP="$STRIP" # Let the user override the test.
-else
-as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-  for ac_exec_ext in '' $ac_executable_extensions; do
-  if $as_executable_p "$as_dir/$ac_word$ac_exec_ext"; then
-    ac_cv_prog_STRIP="${ac_tool_prefix}strip"
-    echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
-    break 2
-  fi
-done
-done
-
-fi
-fi
-STRIP=$ac_cv_prog_STRIP
-if test -n "$STRIP"; then
-  echo "$as_me:$LINENO: result: $STRIP" >&5
-echo "${ECHO_T}$STRIP" >&6
-else
-  echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6
-fi
-
-fi
-if test -z "$ac_cv_prog_STRIP"; then
-  ac_ct_STRIP=$STRIP
-  # Extract the first word of "strip", so it can be a program name with args.
-set dummy strip; ac_word=$2
-echo "$as_me:$LINENO: checking for $ac_word" >&5
-echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6
-if test "${ac_cv_prog_ac_ct_STRIP+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  if test -n "$ac_ct_STRIP"; then
-  ac_cv_prog_ac_ct_STRIP="$ac_ct_STRIP" # Let the user override the test.
-else
-as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-  for ac_exec_ext in '' $ac_executable_extensions; do
-  if $as_executable_p "$as_dir/$ac_word$ac_exec_ext"; then
-    ac_cv_prog_ac_ct_STRIP="strip"
-    echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
-    break 2
-  fi
-done
-done
-
-  test -z "$ac_cv_prog_ac_ct_STRIP" && ac_cv_prog_ac_ct_STRIP=":"
-fi
-fi
-ac_ct_STRIP=$ac_cv_prog_ac_ct_STRIP
-if test -n "$ac_ct_STRIP"; then
-  echo "$as_me:$LINENO: result: $ac_ct_STRIP" >&5
-echo "${ECHO_T}$ac_ct_STRIP" >&6
-else
-  echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6
-fi
-
-  STRIP=$ac_ct_STRIP
-else
-  STRIP="$ac_cv_prog_STRIP"
-fi
 
+missing_dir=`cd $ac_aux_dir && pwd`
+echo "$as_me:$LINENO: checking for working aclocal" >&5
+echo $ECHO_N "checking for working aclocal... $ECHO_C" >&6
+# Run test in a subshell; some versions of sh will print an error if
+# an executable is not found, even if stderr is redirected.
+# Redirect stdin to placate older versions of autoconf.  Sigh.
+if (aclocal --version) < /dev/null > /dev/null 2>&1; then
+   ACLOCAL=aclocal
+   echo "$as_me:$LINENO: result: found" >&5
+echo "${ECHO_T}found" >&6
+else
+   ACLOCAL="$missing_dir/missing aclocal"
+   echo "$as_me:$LINENO: result: missing" >&5
+echo "${ECHO_T}missing" >&6
+fi
+
+echo "$as_me:$LINENO: checking for working autoconf" >&5
+echo $ECHO_N "checking for working autoconf... $ECHO_C" >&6
+# Run test in a subshell; some versions of sh will print an error if
+# an executable is not found, even if stderr is redirected.
+# Redirect stdin to placate older versions of autoconf.  Sigh.
+if (autoconf --version) < /dev/null > /dev/null 2>&1; then
+   AUTOCONF=autoconf
+   echo "$as_me:$LINENO: result: found" >&5
+echo "${ECHO_T}found" >&6
+else
+   AUTOCONF="$missing_dir/missing autoconf"
+   echo "$as_me:$LINENO: result: missing" >&5
+echo "${ECHO_T}missing" >&6
+fi
+
+echo "$as_me:$LINENO: checking for working automake" >&5
+echo $ECHO_N "checking for working automake... $ECHO_C" >&6
+# Run test in a subshell; some versions of sh will print an error if
+# an executable is not found, even if stderr is redirected.
+# Redirect stdin to placate older versions of autoconf.  Sigh.
+if (automake --version) < /dev/null > /dev/null 2>&1; then
+   AUTOMAKE=automake
+   echo "$as_me:$LINENO: result: found" >&5
+echo "${ECHO_T}found" >&6
+else
+   AUTOMAKE="$missing_dir/missing automake"
+   echo "$as_me:$LINENO: result: missing" >&5
+echo "${ECHO_T}missing" >&6
+fi
+
+echo "$as_me:$LINENO: checking for working autoheader" >&5
+echo $ECHO_N "checking for working autoheader... $ECHO_C" >&6
+# Run test in a subshell; some versions of sh will print an error if
+# an executable is not found, even if stderr is redirected.
+# Redirect stdin to placate older versions of autoconf.  Sigh.
+if (autoheader --version) < /dev/null > /dev/null 2>&1; then
+   AUTOHEADER=autoheader
+   echo "$as_me:$LINENO: result: found" >&5
+echo "${ECHO_T}found" >&6
+else
+   AUTOHEADER="$missing_dir/missing autoheader"
+   echo "$as_me:$LINENO: result: missing" >&5
+echo "${ECHO_T}missing" >&6
+fi
+
+echo "$as_me:$LINENO: checking for working makeinfo" >&5
+echo $ECHO_N "checking for working makeinfo... $ECHO_C" >&6
+# Run test in a subshell; some versions of sh will print an error if
+# an executable is not found, even if stderr is redirected.
+# Redirect stdin to placate older versions of autoconf.  Sigh.
+if (makeinfo --version) < /dev/null > /dev/null 2>&1; then
+   MAKEINFO=makeinfo
+   echo "$as_me:$LINENO: result: found" >&5
+echo "${ECHO_T}found" >&6
+else
+   MAKEINFO="$missing_dir/missing makeinfo"
+   echo "$as_me:$LINENO: result: missing" >&5
+echo "${ECHO_T}missing" >&6
 fi
-INSTALL_STRIP_PROGRAM="\${SHELL} \$(install_sh) -c -s"
-
-# We need awk for the "check" target.  The system "awk" is bad on
-# some platforms.
-
 
 
 
@@ -2482,148 +2389,6 @@
 ac_compile='$CC -c $CFLAGS $CPPFLAGS conftest.$ac_ext >&5'
 ac_link='$CC -o conftest$ac_exeext $CFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
 ac_compiler_gnu=$ac_cv_c_compiler_gnu
-rm -f .deps 2>/dev/null
-mkdir .deps 2>/dev/null
-if test -d .deps; then
-  DEPDIR=.deps
-else
-  # MS-DOS does not allow filenames that begin with a dot.
-  DEPDIR=_deps
-fi
-rmdir .deps 2>/dev/null
-
-
-ac_config_commands="$ac_config_commands depfiles"
-
-
-am_make=${MAKE-make}
-cat > confinc << 'END'
-doit:
-	@echo done
-END
-# If we don't find an include directive, just comment out the code.
-echo "$as_me:$LINENO: checking for style of include used by $am_make" >&5
-echo $ECHO_N "checking for style of include used by $am_make... $ECHO_C" >&6
-am__include="#"
-am__quote=
-_am_result=none
-# First try GNU make style include.
-echo "include confinc" > confmf
-# We grep out `Entering directory' and `Leaving directory'
-# messages which can occur if `w' ends up in MAKEFLAGS.
-# In particular we don't look at `^make:' because GNU make might
-# be invoked under some other name (usually "gmake"), in which
-# case it prints its new name instead of `make'.
-if test "`$am_make -s -f confmf 2> /dev/null | fgrep -v 'ing directory'`" = "done"; then
-   am__include=include
-   am__quote=
-   _am_result=GNU
-fi
-# Now try BSD make style include.
-if test "$am__include" = "#"; then
-   echo '.include "confinc"' > confmf
-   if test "`$am_make -s -f confmf 2> /dev/null`" = "done"; then
-      am__include=.include
-      am__quote="\""
-      _am_result=BSD
-   fi
-fi
-
-
-echo "$as_me:$LINENO: result: $_am_result" >&5
-echo "${ECHO_T}$_am_result" >&6
-rm -f confinc confmf
-
-# Check whether --enable-dependency-tracking or --disable-dependency-tracking was given.
-if test "${enable_dependency_tracking+set}" = set; then
-  enableval="$enable_dependency_tracking"
-
-fi;
-if test "x$enable_dependency_tracking" != xno; then
-  am_depcomp="$ac_aux_dir/depcomp"
-  AMDEPBACKSLASH='\'
-fi
-
-
-if test "x$enable_dependency_tracking" != xno; then
-  AMDEP_TRUE=
-  AMDEP_FALSE='#'
-else
-  AMDEP_TRUE='#'
-  AMDEP_FALSE=
-fi
-
-
-
-
-depcc="$CC"   am_compiler_list=
-
-echo "$as_me:$LINENO: checking dependency style of $depcc" >&5
-echo $ECHO_N "checking dependency style of $depcc... $ECHO_C" >&6
-if test "${am_cv_CC_dependencies_compiler_type+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  if test -z "$AMDEP_TRUE" && test -f "$am_depcomp"; then
-  # We make a subdir and do the tests there.  Otherwise we can end up
-  # making bogus files that we don't know about and never remove.  For
-  # instance it was reported that on HP-UX the gcc test will end up
-  # making a dummy file named `D' -- because `-MD' means `put the output
-  # in D'.
-  mkdir conftest.dir
-  # Copy depcomp to subdir because otherwise we won't find it if we're
-  # using a relative directory.
-  cp "$am_depcomp" conftest.dir
-  cd conftest.dir
-
-  am_cv_CC_dependencies_compiler_type=none
-  if test "$am_compiler_list" = ""; then
-     am_compiler_list=`sed -n 's/^#*\([a-zA-Z0-9]*\))$/\1/p' < ./depcomp`
-  fi
-  for depmode in $am_compiler_list; do
-    # We need to recreate these files for each test, as the compiler may
-    # overwrite some of them when testing with obscure command lines.
-    # This happens at least with the AIX C compiler.
-    echo '#include "conftest.h"' > conftest.c
-    echo 'int i;' > conftest.h
-    echo "${am__include} ${am__quote}conftest.Po${am__quote}" > confmf
-
-    case $depmode in
-    nosideeffect)
-      # after this tag, mechanisms are not by side-effect, so they'll
-      # only be used when explicitly requested
-      if test "x$enable_dependency_tracking" = xyes; then
-	continue
-      else
-	break
-      fi
-      ;;
-    none) break ;;
-    esac
-    # We check with `-c' and `-o' for the sake of the "dashmstdout"
-    # mode.  It turns out that the SunPro C++ compiler does not properly
-    # handle `-M -o', and we need to detect this.
-    if depmode=$depmode \
-       source=conftest.c object=conftest.o \
-       depfile=conftest.Po tmpdepfile=conftest.TPo \
-       $SHELL ./depcomp $depcc -c conftest.c -o conftest.o >/dev/null 2>&1 &&
-       grep conftest.h conftest.Po > /dev/null 2>&1 &&
-       ${MAKE-make} -s -f confmf > /dev/null 2>&1; then
-      am_cv_CC_dependencies_compiler_type=$depmode
-      break
-    fi
-  done
-
-  cd ..
-  rm -rf conftest.dir
-else
-  am_cv_CC_dependencies_compiler_type=none
-fi
-
-fi
-echo "$as_me:$LINENO: result: $am_cv_CC_dependencies_compiler_type" >&5
-echo "${ECHO_T}$am_cv_CC_dependencies_compiler_type" >&6
-CCDEPMODE=depmode=$am_cv_CC_dependencies_compiler_type
-
 
 # Find a good install program.  We prefer a C program (faster),
 # so one script is as good as another.  But avoid the broken or
@@ -5733,6 +5498,85 @@
 
 #----------------------------------------------------------------------
 
+echo "$as_me:$LINENO: checking whether spamassassin is enabled" >&5
+echo $ECHO_N "checking whether spamassassin is enabled... $ECHO_C" >&6
+# Check whether --enable-spamassassin or --disable-spamassassin was given.
+if test "${enable_spamassassin+set}" = set; then
+  enableval="$enable_spamassassin"
+  ENABLE_SPAMASSASSIN=$enableval
+else
+
+                        ENABLE_SPAMASSASSIN=0
+
+
+fi;
+
+case $ENABLE_SPAMASSASSIN in
+  0*|n*|N*)
+      echo "$as_me:$LINENO: result: no" >&5
+echo "${ECHO_T}no" >&6
+      ;;
+  *)
+      echo "$as_me:$LINENO: result: yes" >&5
+echo "${ECHO_T}yes" >&6
+      ENABLE_SPAMASSASSIN=1
+
+cat >>confdefs.h <<_ACEOF
+#define SPAMASSASSIN $ENABLE_SPAMASSASSIN
+_ACEOF
+
+
+    echo "$as_me:$LINENO: checking whether we can locate the spamc program" >&5
+echo $ECHO_N "checking whether we can locate the spamc program... $ECHO_C" >&6
+    for f in /usr/bin/spamc /usr/local/bin/spamc
+    do
+        if test -f $f
+        then
+            spamc_prog=$f
+            break
+        fi
+    done
+    # Check whether --enable-spamc-prog or --disable-spamc-prog was given.
+if test "${enable_spamc_prog+set}" = set; then
+  enableval="$enable_spamc_prog"
+  spamc_prog="$enableval"
+else
+
+            if test "$spamc_prog" = ""
+            then
+                echo "$as_me:$LINENO: result: no" >&5
+echo "${ECHO_T}no" >&6
+                { { echo "$as_me:$LINENO: error: Unable to find your spamc prog, specify --enable-spamc-prog." >&5
+echo "$as_me: error: Unable to find your spamc prog, specify --enable-spamc-prog." >&2;}
+   { (exit 1); exit 1; }; }
+            fi
+
+
+fi;
+
+    if test ! -f "$spamc_prog"
+    then
+        echo "$as_me:$LINENO: result: no" >&5
+echo "${ECHO_T}no" >&6
+        { { echo "$as_me:$LINENO: error: Unable to find your spamc program, specify --enable-spamc-prog=/full/path/to/spamc" >&5
+echo "$as_me: error: Unable to find your spamc program, specify --enable-spamc-prog=/full/path/to/spamc" >&2;}
+   { (exit 1); exit 1; }; }
+    fi
+
+    echo "$as_me:$LINENO: result: yes" >&5
+echo "${ECHO_T}yes" >&6
+
+cat >>confdefs.h <<_ACEOF
+#define SPAMC_PROG "$spamc_prog"
+_ACEOF
+
+
+      ;;
+esac
+
+
+#----------------------------------------------------------------------
+
 echo "$as_me:$LINENO: checking whether domainquotas is enabled" >&5
 echo $ECHO_N "checking whether domainquotas is enabled... $ECHO_C" >&6
 # Check whether --enable-domainquotas or --disable-domainquotas was given.
@@ -6882,13 +6726,6 @@
 
 DEFS=-DHAVE_CONFIG_H
 
-if test -z "${AMDEP_TRUE}" && test -z "${AMDEP_FALSE}"; then
-  { { echo "$as_me:$LINENO: error: conditional \"AMDEP\" was never defined.
-Usually this means the macro was only invoked conditionally." >&5
-echo "$as_me: error: conditional \"AMDEP\" was never defined.
-Usually this means the macro was only invoked conditionally." >&2;}
-   { (exit 1); exit 1; }; }
-fi
 
 : ${CONFIG_STATUS=./config.status}
 ac_clean_files_save=$ac_clean_files
@@ -7283,7 +7120,7 @@
 # INIT-COMMANDS section.
 #
 
-AMDEP_TRUE="$AMDEP_TRUE" ac_aux_dir="$ac_aux_dir"
+
 
 _ACEOF
 
@@ -7295,7 +7132,7 @@
   case "$ac_config_target" in
   # Handling of arguments.
   "Makefile" ) CONFIG_FILES="$CONFIG_FILES Makefile" ;;
-  "depfiles" ) CONFIG_COMMANDS="$CONFIG_COMMANDS depfiles" ;;
+  "default-1" ) CONFIG_COMMANDS="$CONFIG_COMMANDS default-1" ;;
   "config.h" ) CONFIG_HEADERS="$CONFIG_HEADERS config.h" ;;
   *) { { echo "$as_me:$LINENO: error: invalid argument: $ac_config_target" >&5
 echo "$as_me: error: invalid argument: $ac_config_target" >&2;}
@@ -7389,12 +7226,6 @@
 s,@AUTOMAKE@,$AUTOMAKE,;t t
 s,@AUTOHEADER@,$AUTOHEADER,;t t
 s,@MAKEINFO@,$MAKEINFO,;t t
-s,@AMTAR@,$AMTAR,;t t
-s,@install_sh@,$install_sh,;t t
-s,@STRIP@,$STRIP,;t t
-s,@ac_ct_STRIP@,$ac_ct_STRIP,;t t
-s,@INSTALL_STRIP_PROGRAM@,$INSTALL_STRIP_PROGRAM,;t t
-s,@AWK@,$AWK,;t t
 s,@SET_MAKE@,$SET_MAKE,;t t
 s,@build@,$build,;t t
 s,@build_cpu@,$build_cpu,;t t
@@ -7404,6 +7235,7 @@
 s,@host_cpu@,$host_cpu,;t t
 s,@host_vendor@,$host_vendor,;t t
 s,@host_os@,$host_os,;t t
+s,@AWK@,$AWK,;t t
 s,@CC@,$CC,;t t
 s,@CFLAGS@,$CFLAGS,;t t
 s,@LDFLAGS@,$LDFLAGS,;t t
@@ -7411,13 +7243,6 @@
 s,@ac_ct_CC@,$ac_ct_CC,;t t
 s,@EXEEXT@,$EXEEXT,;t t
 s,@OBJEXT@,$OBJEXT,;t t
-s,@DEPDIR@,$DEPDIR,;t t
-s,@am__include@,$am__include,;t t
-s,@am__quote@,$am__quote,;t t
-s,@AMDEP_TRUE@,$AMDEP_TRUE,;t t
-s,@AMDEP_FALSE@,$AMDEP_FALSE,;t t
-s,@AMDEPBACKSLASH@,$AMDEPBACKSLASH,;t t
-s,@CCDEPMODE@,$CCDEPMODE,;t t
 s,@RANLIB@,$RANLIB,;t t
 s,@ac_ct_RANLIB@,$ac_ct_RANLIB,;t t
 s,@CPP@,$CPP,;t t
@@ -7844,12 +7669,6 @@
     cat $tmp/config.h
     rm -f $tmp/config.h
   fi
-  # Run the commands associated with the file.
-  case $ac_file in
-    config.h ) # update the timestamp
-echo 'timestamp for config.h' >"./stamp-h1"
- ;;
-  esac
 done
 _ACEOF
 cat >>$CONFIG_STATUS <<\_ACEOF
@@ -7908,92 +7727,7 @@
   { echo "$as_me:$LINENO: executing $ac_dest commands" >&5
 echo "$as_me: executing $ac_dest commands" >&6;}
   case $ac_dest in
-    depfiles ) test x"$AMDEP_TRUE" != x"" || for mf in $CONFIG_FILES; do
-  # Strip MF so we end up with the name of the file.
-  mf=`echo "$mf" | sed -e 's/:.*$//'`
-  # Check whether this is an Automake generated Makefile or not.
-  # We used to match only the files named `Makefile.in', but
-  # some people rename them; so instead we look at the file content.
-  # Grep'ing the first line is not enough: some people post-process
-  # each Makefile.in and add a new line on top of each file to say so.
-  # So let's grep whole file.
-  if grep '^#.*generated by automake' $mf > /dev/null 2>&1; then
-    dirpart=`(dirname "$mf") 2>/dev/null ||
-$as_expr X"$mf" : 'X\(.*[^/]\)//*[^/][^/]*/*$' \| \
-         X"$mf" : 'X\(//\)[^/]' \| \
-         X"$mf" : 'X\(//\)$' \| \
-         X"$mf" : 'X\(/\)' \| \
-         .     : '\(.\)' 2>/dev/null ||
-echo X"$mf" |
-    sed '/^X\(.*[^/]\)\/\/*[^/][^/]*\/*$/{ s//\1/; q; }
-  	  /^X\(\/\/\)[^/].*/{ s//\1/; q; }
-  	  /^X\(\/\/\)$/{ s//\1/; q; }
-  	  /^X\(\/\).*/{ s//\1/; q; }
-  	  s/.*/./; q'`
-  else
-    continue
-  fi
-  grep '^DEP_FILES *= *[^ #]' < "$mf" > /dev/null || continue
-  # Extract the definition of DEP_FILES from the Makefile without
-  # running `make'.
-  DEPDIR=`sed -n -e '/^DEPDIR = / s///p' < "$mf"`
-  test -z "$DEPDIR" && continue
-  # When using ansi2knr, U may be empty or an underscore; expand it
-  U=`sed -n -e '/^U = / s///p' < "$mf"`
-  test -d "$dirpart/$DEPDIR" || mkdir "$dirpart/$DEPDIR"
-  # We invoke sed twice because it is the simplest approach to
-  # changing $(DEPDIR) to its actual value in the expansion.
-  for file in `sed -n -e '
-    /^DEP_FILES = .*\\\\$/ {
-      s/^DEP_FILES = //
-      :loop
-	s/\\\\$//
-	p
-	n
-	/\\\\$/ b loop
-      p
-    }
-    /^DEP_FILES = / s/^DEP_FILES = //p' < "$mf" | \
-       sed -e 's/\$(DEPDIR)/'"$DEPDIR"'/g' -e 's/\$U/'"$U"'/g'`; do
-    # Make sure the directory exists.
-    test -f "$dirpart/$file" && continue
-    fdir=`(dirname "$file") 2>/dev/null ||
-$as_expr X"$file" : 'X\(.*[^/]\)//*[^/][^/]*/*$' \| \
-         X"$file" : 'X\(//\)[^/]' \| \
-         X"$file" : 'X\(//\)$' \| \
-         X"$file" : 'X\(/\)' \| \
-         .     : '\(.\)' 2>/dev/null ||
-echo X"$file" |
-    sed '/^X\(.*[^/]\)\/\/*[^/][^/]*\/*$/{ s//\1/; q; }
-  	  /^X\(\/\/\)[^/].*/{ s//\1/; q; }
-  	  /^X\(\/\/\)$/{ s//\1/; q; }
-  	  /^X\(\/\).*/{ s//\1/; q; }
-  	  s/.*/./; q'`
-    { case $dirpart/$fdir in
-  [\\/]* | ?:[\\/]* ) as_incr_dir=;;
-  *)                      as_incr_dir=.;;
-esac
-as_dummy=$dirpart/$fdir
-for as_mkdir_dir in `IFS='/\\'; set X $as_dummy; shift; echo "$@"`; do
-  case $as_mkdir_dir in
-    # Skip DOS drivespec
-    ?:) as_incr_dir=$as_mkdir_dir ;;
-    *)
-      as_incr_dir=$as_incr_dir/$as_mkdir_dir
-      test -d "$as_incr_dir" ||
-        mkdir "$as_incr_dir" ||
-	{ { echo "$as_me:$LINENO: error: cannot create $dirpart/$fdir" >&5
-echo "$as_me: error: cannot create $dirpart/$fdir" >&2;}
-   { (exit 1); exit 1; }; }
-    ;;
-  esac
-done; }
-
-    # echo "creating $dirpart/$file"
-    echo '# dummy' > "$dirpart/$file"
-  done
-done
- ;;
+    default-1 ) test -z "$CONFIG_HEADERS" || echo timestamp > stamp-h ;;
   esac
 done
 _ACEOF
@@ -8295,6 +8029,16 @@
     echo "one domain per SQL table     = --disable-many-domains"
   fi
 fi
+
+case $ENABLE_SPAMASSASSIN in
+  1*|y*|Y*)
+    echo "      spamassassin = ON  --enable-spamassassin"
+    ;;
+  *)
+    echo "      spamassassin = OFF --disable-spamassassin (default)"
+    ;;
+esac
+
 
 echo "${CC} -O2" > cdb/conf-cc
 echo "${CC} -s" > cdb/conf-ld
diff -urN ../vpopmail-5.4.10/configure.in ./configure.in
--- ../vpopmail-5.4.10/configure.in	Sun Mar 20 07:38:35 2005
+++ ./configure.in	Thu Apr 28 12:35:59 2005
@@ -823,6 +823,60 @@
 
 #----------------------------------------------------------------------
 
+AC_MSG_CHECKING(whether spamassassin is enabled)
+AC_ARG_ENABLE(spamassassin,
+        [  --enable-spamassassin      Enable spamassassin. See  README.spamassassin for more info.],
+        ENABLE_SPAMASSASSIN=$enableval,
+                [
+                        ENABLE_SPAMASSASSIN=0
+                ]
+)
+
+case $ENABLE_SPAMASSASSIN in
+  0*|n*|N*)
+      AC_MSG_RESULT(no)
+      ;;
+  *)
+      AC_MSG_RESULT(yes)
+      ENABLE_SPAMASSASSIN=1
+      AC_DEFINE_UNQUOTED(SPAMASSASSIN,$ENABLE_SPAMASSASSIN,"")
+
+    AC_MSG_CHECKING(whether we can locate the spamc program)
+    for f in /usr/bin/spamc /usr/local/bin/spamc
+    do
+        if test -f $f
+        then
+            spamc_prog=$f
+            break
+        fi
+    done
+    AC_ARG_ENABLE(spamc-prog,
+        [  --enable-spamc-prog=PATH    Full path to spamc program [/usr/{local/}bin/spamc].],
+        spamc_prog="$enableval",
+        [
+            if test "$spamc_prog" = ""
+            then
+                AC_MSG_RESULT(no)
+                AC_MSG_ERROR([Unable to find your spamc prog, specify --enable-spamc-prog.])
+            fi
+        ]
+    )
+
+    if test ! -f "$spamc_prog"
+    then
+        AC_MSG_RESULT(no)
+        AC_MSG_ERROR([Unable to find your spamc program, specify --enable-spamc-prog=/full/path/to/spamc])
+    fi
+
+    AC_MSG_RESULT(yes)
+    AC_DEFINE_UNQUOTED(SPAMC_PROG,"$spamc_prog","")
+
+      ;;
+esac
+
+
+#----------------------------------------------------------------------
+
 AC_MSG_CHECKING(whether domainquotas is enabled)
 AC_ARG_ENABLE(domainquotas,
         [  --enable-domainquotas      Enable non-system domain quotas. See README.quotas for more info.],
@@ -1674,6 +1728,16 @@
     echo "one domain per SQL table     = --disable-many-domains"
   fi
 fi
+
+case $ENABLE_SPAMASSASSIN in
+  1*|y*|Y*)
+    echo "      spamassassin = ON  --enable-spamassassin"
+    ;;
+  *)
+    echo "      spamassassin = OFF --disable-spamassassin (default)"
+    ;;
+esac
+
 
 echo "${CC} -O2" > cdb/conf-cc
 echo "${CC} -s" > cdb/conf-ld
diff -urN ../vpopmail-5.4.10/vdelivermail.c ./vdelivermail.c
--- ../vpopmail-5.4.10/vdelivermail.c	Wed May 26 17:31:09 2004
+++ ./vdelivermail.c	Thu Apr 28 12:51:05 2005
@@ -37,6 +37,9 @@
 #ifdef MAKE_SEEKABLE
 #include "seek.h"
 #endif
+#ifdef SPAMASSASSIN
+#include "vlimits.h"
+#endif
 
 /* Globals */
 #define AUTH_SIZE 300
@@ -63,6 +66,11 @@
 char hostname[FILE_SIZE];
 char loop_buf[FILE_SIZE];
 
+#ifdef SPAMASSASSIN
+int  InHeaders = 1;
+int is_spam();
+#endif
+
 #define MSG_BUF_SIZE 5000
 char msgbuf[MSG_BUF_SIZE];
 
@@ -444,6 +452,11 @@
  int write_fd;
  FILE *fs;
  char tmp_file[256];
+#ifdef SPAMASSASSIN
+  int  pim[2];
+  int  local = 0;
+  struct vlimits limits;
+#endif
 
     /* This is a comment, ignore it */
     if ( *address == '#' ) return(0);
@@ -535,6 +548,10 @@
         }
 #endif
 
+#ifdef SPAMASSASSIN
+        local = 1;
+#endif
+
         /* Format the email file name */
         gethostname(hostname,sizeof(hostname));
         pid=getpid();
@@ -631,9 +648,62 @@
         }
     }
 
+#ifdef SPAMASSASSIN
+    InHeaders=1;
+    /* fork the SpamAssassin client - based on work by Alex Dupre */
+    if ( local==1 ) {
+      vget_limits(TheDomain, &limits);
+      if ( vpw==NULL ) {
+        parse_email(maildir_to_email(address), TheUser, TheDomain, AUTH_SIZE);
+        vpw=vauth_getpw(TheUser, TheDomain);
+      }
+      if ( limits.disable_spamassassin==0 && vpw!=NULL &&
+           !(vpw->pw_gid & NO_SPAMASSASSIN) ) {
+
+        if (!pipe(pim)) {
+          pid = vfork();
+          switch (pid) {
+           case -1:
+            close(pim[0]);
+            close(pim[1]);
+            break;
+           case 0:
+            close(pim[0]);
+            dup2(pim[1], 1);
+            close(pim[1]);
+            if (execl(SPAMC_PROG, SPAMC_PROG, "-f", "-u",
+                 maildir_to_email(address), 0) == -1) {
+              while ((file_count = read(0, msgbuf, MSG_BUF_SIZE)) > 0) {
+                write(1, msgbuf, file_count);
+              }
+              _exit(0);
+            }
+          }
+          close(pim[1]);
+          dup2(pim[0], 0);
+          close(pim[0]);
+        }
+      }
+    }
+#endif
+
 
     /* read it in chunks and write it to the new file */
     while((file_count=read(0,msgbuf,MSG_BUF_SIZE))>0) {
+#ifdef SPAMASSASSIN
+        if ( local==1 && InHeaders==1 &&
+             (limits.delete_spam==1 || vpw->pw_gid & DELETE_SPAM) ) {
+          printf("check is_spam\n");
+          if (is_spam(msgbuf) == 1) {
+            close(write_fd);
+            if (unlink(local_file) != 0) {
+              printf("unlink failed %s errno = %d\n", local_file, errno);
+              return(errno);
+            }
+            return(0);
+          }
+        }
+#endif
         if ( write(write_fd,msgbuf,file_count) == -1 ) {
             close(write_fd);
 
@@ -1300,3 +1370,56 @@
    return(1);
 }
 
+#ifdef SPAMASSASSIN
+/* Check for a spam message
+ *  * This is done by checking for a matching line
+ *   * in the email headers for X-Spam-Level: which
+ *    * we put in each spam email
+ *     *
+ *      * Return 1 if spam
+ *       * Return 0 if not spam
+ *        * Return -1 on error
+ *         */
+int is_spam(char *spambuf)
+{
+ int i,j,k;
+ int found;
+
+    for(i=0,j=0;spambuf[i]!=0;++i) {
+
+       /* found a line */
+       if (spambuf[i]=='\n' || spambuf[i]=='\r' ) {
+
+         /* check for blank line, end of headers */
+         for(k=j,found=0;k<i;++k) {
+           switch(spambuf[k]) {
+             /* skip blank spaces and new lines */
+             case ' ':
+             case '\n':
+             case '\t':
+             case '\r':
+               break;
+
+             /* found a non blank, so we are still
+              * in the headers
+              */
+             default:
+               /* set the found non blank char flag */
+               found = 1;
+               break;
+           }
+         }
+         if ( found == 0 ) {
+           InHeaders=0;
+           return(0);
+         }
+
+         /* still in the headers check for spam header */
+         if ( strncmp(&spambuf[j], "X-Spam-Flag: YES", 16 ) == 0 ) return(1);
+
+         if (spambuf[i+1]!=0) j=i+1;
+       }
+     }
+     return(0);
+}
+#endif
diff -urN ../vpopmail-5.4.10/vlimits.c ./vlimits.c
--- ../vpopmail-5.4.10/vlimits.c	Sun Jan 23 09:05:04 2005
+++ ./vlimits.c	Thu Apr 28 12:35:59 2005
@@ -139,6 +139,14 @@
                 limits->disable_webmail = 1;
             }
 
+            if (!strcmp(s1, "disable_spamassassin")) {
+                limits->disable_spamassassin = 1;
+            }
+
+            if (!strcmp(s1, "delete_spam")) {
+                limits->delete_spam = 1;
+            }
+
             if (!strcmp(s1, "perm_account")) {
                 if ((s2 = strtok(NULL, TOKENS)) == NULL)
                     continue;
@@ -217,6 +225,8 @@
         if (limits->disable_webmail) fprintf(fs, "disable_webmail\n");
         if (limits->disable_relay) fprintf(fs, "disable_external_relay\n");
         if (limits->disable_smtp) fprintf(fs, "disable_smtp\n");
+        if (limits->disable_spamassassin) fprintf(fs, "disable_spamassassin\n");
+        if (limits->delete_spam) fprintf(fs, "delete_spam\n");
         fprintf(fs, "perm_account: %d\n", limits->perm_account);
         fprintf(fs, "perm_alias: %d\n", limits->perm_alias);
         fprintf(fs, "perm_forward: %d\n", limits->perm_forward);
@@ -257,6 +267,12 @@
     }
     if (limits->disable_dialup != 0) {
         mask |= NO_DIALUP;
+    }
+    if (limits->disable_spamassassin != 0) {
+        mask |= NO_SPAMASSASSIN;
+    }
+    if (limits->delete_spam != 0) {
+        mask |= DELETE_SPAM;
     }
     return mask;
     /* this feature has been temporarily disabled until we can figure
diff -urN ../vpopmail-5.4.10/vlimits.h ./vlimits.h
--- ../vpopmail-5.4.10/vlimits.h	Wed Dec  3 08:41:14 2003
+++ ./vlimits.h	Thu Apr 28 12:35:59 2005
@@ -37,6 +37,8 @@
       short     disable_webmail;
       short     disable_relay;
       short     disable_smtp;
+      short     disable_spamassassin;
+      short     delete_spam;
 
       /* the following permissions are for non-postmaster admins */
       short     perm_account;
diff -urN ../vpopmail-5.4.10/vmoddomlimits.c ./vmoddomlimits.c
--- ../vpopmail-5.4.10/vmoddomlimits.c	Sun Oct 17 22:35:06 2004
+++ ./vmoddomlimits.c	Thu Apr 28 12:37:48 2005
@@ -153,6 +153,14 @@
                 printf("  NO_DIALUP\n");
                 strncat(OptionString, "u", sizeof(OptionString)-strlen(OptionString)-1);
             }
+            if (limits.disable_spamassassin != 0) {
+                printf("  NO_SPAMASSASSIN\n");
+                strncat(OptionString, "c", sizeof(OptionString)-strlen(OptionString)-1);
+            }
+            if (limits.delete_spam != 0) {
+                printf("  DEL_SPAM\n");
+                strncat(OptionString, "x", sizeof(OptionString)-strlen(OptionString)-1);
+            }
             printf("Flags (for commandline): %s\n", OptionString);
             printf("Flags for non postmaster accounts:");
             printf("\n  pop account:            ");
@@ -239,6 +247,8 @@
             limits.disable_webmail = 0;
             limits.disable_imap = 0;
             limits.disable_relay = 0;
+            limits.disable_spamassassin = 0;
+            limits.delete_spam = 0;
             for (i=0; i<strlen(GidFlagString); i++) {
                 switch(GidFlagString[i]) {
                     case 'u': limits.disable_dialup = 1; break;
@@ -248,6 +258,8 @@
                     case 'w': limits.disable_webmail = 1; break;
                     case 'i': limits.disable_imap = 1; break;
                     case 'r': limits.disable_relay = 1; break;
+                    case 'c': limits.disable_spamassassin = 1; break;
+                    case 'x': limits.delete_spam = 1; break;
                 }
             }
         }
@@ -395,6 +407,8 @@
     printf("            w ( set no web mail access flag )\n");
     printf("            i ( set no imap access flag )\n");
     printf("            r ( set no external relay flag )\n");
+    printf("            c ( set no spamassasssin flag )\n");
+    printf("            x ( set delete spam flag )\n");
     
     printf("the following options are bit flags for non postmaster admins\n");
     printf("         -p \"flags\"  (set pop account flags)\n");
diff -urN ../vpopmail-5.4.10/vmoduser.c ./vmoduser.c
--- ../vpopmail-5.4.10/vmoduser.c	Fri Feb  4 07:45:46 2005
+++ ./vmoduser.c	Thu Apr 28 12:35:59 2005
@@ -150,6 +150,8 @@
     printf("         -1 ( set V_USER1 flag )\n"); 
     printf("         -2 ( set V_USER2 flag )\n"); 
     printf("         -3 ( set V_USER3 flag )\n"); 
+    printf("         -f ( disable spamassassin)\n");
+    printf("         -F ( delete spam)\n");
 
 }
 
@@ -172,7 +174,7 @@
     NoMakeIndex = 0;
 
     errflag = 0;
-    while( (c=getopt(argc,argv,"D:avunxc:q:dpswibro0123he:C:")) != -1 ) {
+    while( (c=getopt(argc,argv,"D:avunxc:q:dpswibro0123he:C:fF")) != -1 ) {
         switch(c) {
             case 'v':
                 printf("version: %s\n", VERSION);
@@ -241,6 +243,12 @@
                 break;
             case 'a':
                 GidFlag |= QA_ADMIN;
+                break;
+            case 'f':
+                GidFlag |= NO_SPAMASSASSIN;
+                break;
+            case 'F':
+                GidFlag |= DELETE_SPAM;
                 break;
             case 'h':
                 usage();
